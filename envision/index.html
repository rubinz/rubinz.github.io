<html>

    <head>
      <title>Envision</title>
      <link rel="stylesheet" type="text/css" href="style.css" />
    </head>

    <body>
    	
        <div id="banner">
        	
        	<select id="settings" autocomplete="off" onchange="choosecolor()">
				<option>Settings</option>
				<optgroup label="Color Settings">
					<option value=red>Red-Green Gradient</option>
					<option value=texture>Texture Based Gradient</option>
					<option value=blue>Blue-Yellow Gradient</option>
				</optgroup>
				<optgroup label="Labels">
					<option value=labelon>On</option>
					<option value=labeloff>Off</option>
				</optgroup>
			</select>
			<img id="logo" src="banner.png"></img>
        </div><!--close banner-->
        <div id="settingsbar">
			</div>	
        
        <div id="site_content">	
        </div><!--close site_content-->
        <div id="footer">
        	<img id="foot" src="footer.png"></img>
        	<div id="update"></div> 
        </div><!--close footer-->	
		
		<svg width=0 height=0>
    
    <defs> 
	  <pattern id="pattern1"
			   x="0" y="0" width="32" height="32"
			   patternUnits="userSpaceOnUse" >

		  <circle cx="16" cy="16" r="16" style="stroke: none; fill: #0000ff" />

	  </pattern>
	  
	  <pattern id="pattern2"
			   x="0" y="0" width="30" height="30"
			   patternUnits="userSpaceOnUse" >

		  <circle cx="15" cy="15" r="15" style="stroke: none; fill: #0000ff" />

	  </pattern>
	  
	  <pattern id="pattern3"
			   x="0" y="0" width="28" height="28"
			   patternUnits="userSpaceOnUse" >

		  <circle cx="14" cy="14" r="14" style="stroke: none; fill: #0000ff" />

	  </pattern>
	  
	  <pattern id="pattern4"
			   x="0" y="0" width="26" height="26"
			   patternUnits="userSpaceOnUse" >

		  <circle cx="13" cy="13" r="13" style="stroke: none; fill: #0000ff" />

	  </pattern>
	  
	  <pattern id="pattern5"
			   x="0" y="0" width="24" height="24"
			   patternUnits="userSpaceOnUse" >

		  <circle cx="12" cy="12" r="12" style="stroke: none; fill: #0000ff" />

	  </pattern>
	  
	  <pattern id="pattern6"
			   x="0" y="0" width="22" height="22"
			   patternUnits="userSpaceOnUse" >

		  <circle cx="11" cy="11" r="11" style="stroke: none; fill: #0000ff" />

	  </pattern>
	  
	  <pattern id="pattern7"
			   x="0" y="0" width="20" height="20"
			   patternUnits="userSpaceOnUse" >

		  <circle cx="10" cy="10" r="10" style="stroke: none; fill: #0000ff" />

	  </pattern>
	  
	  <pattern id="pattern8"
			   x="0" y="0" width="18" height="18"
			   patternUnits="userSpaceOnUse" >

		  <circle cx="9" cy="9" r="9" style="stroke: none; fill: #0000ff" />

	  </pattern>
	  
	  <pattern id="pattern9"
			   x="0" y="0" width="16" height="16"
			   patternUnits="userSpaceOnUse" >

		  <circle cx="8" cy="8" r="8" style="stroke: none; fill: #0000ff" />

	  </pattern>
	  
	  <pattern id="pattern10"
			   x="0" y="0" width="14" height="14"
			   patternUnits="userSpaceOnUse" >

		  <circle cx="7" cy="7" r="7" style="stroke: none; fill: #0000ff" />

	  </pattern>
	  
	  <pattern id="pattern11"
			   x="0" y="0" width="12" height="12"
			   patternUnits="userSpaceOnUse" >

		  <circle cx="6" cy="6" r="6" style="stroke: none; fill: #0000ff" />

	  </pattern>
	  
	  <pattern id="pattern12"
			   x="0" y="0" width="10" height="10"
			   patternUnits="userSpaceOnUse" >

		  <circle cx="5" cy="5" r="5" style="stroke: none; fill: #0000ff" />

	  </pattern>
	  
	  <pattern id="pattern13"
			   x="0" y="0" width="8" height="8"
			   patternUnits="userSpaceOnUse" >

		  <circle cx="4" cy="4" r="4" style="stroke: none; fill: #0000ff" />

	  </pattern>
	  
	  <pattern id="pattern14"
			   x="0" y="0" width="6" height="6"
			   patternUnits="userSpaceOnUse" >

		  <circle cx="3" cy="3" r="3" style="stroke: none; fill: #0000ff" />

	  </pattern>
	  
	  <pattern id="pattern15"
			   x="0" y="0" width="4" height="4"
			   patternUnits="userSpaceOnUse" >

		  <circle cx="2" cy="2" r="2" style="stroke: none; fill: #0000ff" />

	  </pattern>
	  
	  <pattern id="pattern16"
			   x="0" y="0" width="2" height="2"
			   patternUnits="userSpaceOnUse" >

		  <circle cx="1" cy="1" r="1" style="stroke: none; fill: #0000ff" />

	  </pattern>
	</defs>
	</svg>
		
        <script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
        <script type="text/javascript" src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
        <script>
    	
    		function getRank(dormname)
    		{
    			for(var i = 0; i < recent.length; i++)
    			{
    				if(recent[i].name == dormname)
    					return (17-(i+1));
    			}
    		}
    		
        	function drawbackground()
        	{	
        		svg = d3.select("#site_content").append("svg").attr("width", 1200).attr("id", "mainsvg").attr("height", 920).append("g");

        		
        		tooltip = d3.select("body").append("div")		//create tooltip for mouseover data
				.attr("class", "tooltip")
				.style("opacity", 0);
        		
        		 svg.append("rect")
 					.attr("id", "border")
 					.attr("fill", "#373737")
 					.attr("width", "100%")
 					.attr("height", "920px");
        			
        		
        		svg.append("svg:image")
      				.attr("xlink:href", "map.png")
      				.attr("width", "1176")
      				.attr("height", "98%")
      				//.attr("transform", "translate(12,10)")
      				.attr("x",12)
      				.attr("y",function(){isChrome = !!window.chrome && !!window.chrome.webstore;
      										if(isChrome)
      											return 0;
      										else
      											return 10;})
      				.attr("id", "map");
      				
      			
      			
      			
      			svg.append("rect")
 					.attr("id", "keyborder")
 					.attr("fill", "#373737")
 					.attr("width", "210")
 					.attr("height", "130px")
 					.attr("x", 980)
 					.attr("y", 820);
      			
      			svg.append("svg:image")
      				.attr("xlink:href", "redGreenGradient.png")
      				.attr("width", "180")
      				.attr("height", "100%")
      				.attr("x",1000)
      				.attr("y",400)
      				.attr("class", "rggradient");
      				
      			svg.append("text")
					.attr("font-size", "14px")
					.attr("x", 1000)
					.attr("y", 903)
					.attr("fill", "white")
					.text("High ");
				svg.append("text")
					.attr("font-size", "14px")
					.attr("x", 1155)
					.attr("y", 903)
					.attr("fill", "white")
					.text("Low ");
      				
      			svg.append("polyline")
					.attr("points", "405,255 446,255 446,295 440,295 440,308 436,308 436,295 405,295")
					.attr("style", "fill:black")
					.attr("id", "larcombuilding")
					.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("Dorm: Larcom <br> Rank: "+getRank("larcom")+" <br> Energy Usage: " + (larcom[0]).energy.toFixed(2) + " kwh"
          							+ "<br>Cost: $" + (moneyconversion*larcom[larcom.length-1].energy).toFixed(2)
          							+ "<br>CO<sub>2</sub> Emission: "+ (co2conversion*larcom[larcom.length-1].energy).toFixed(2) + " lbs")
               					.style("left", (d3.event.pageX + 5) + "px")
               					.style("top", (d3.event.pageY - 28) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
               		.on("click", function(d) {					//hide info on mouseout
          				newsvg("Larcom");});
					
				svg.append("polyline")
					.attr("points", "305,74 343,74 343,155 305,155 ")
					.attr("style", "fill:black")
					.attr("id", "kilhambuilding")
					.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("Dorm: Kilham <br> Rank: "+getRank("kilham")+" <br> Energy Usage: " + (kilham[0].energy).toFixed(2) + " kwh"
          							+ "<br>Cost: $" + (moneyconversion*kilham[0].energy).toFixed(2)
          							+ "<br>CO<sub>2</sub> Emission: "+ (co2conversion*kilham[0].energy).toFixed(2) + " lbs")
               					.style("left", (d3.event.pageX + 5) + "px")
               					.style("top", (d3.event.pageY - 28) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
               		.on("click", function(d) {					//hide info on mouseout
          				newsvg("Kilham");});
					
				svg.append("polyline")
					.attr("points", "406,74 444,74 444,155 406,155 ")
					.attr("style", "fill:black")
					.attr("id", "metcalfbuilding")
					.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("Dorm: Metcalf <br> Rank: "+getRank("metcalf")+" <br> Energy Usage: " + (metcalf[0].energy).toFixed(2) + " kwh"
          							+ "<br>Cost: $" + (moneyconversion*metcalf[0].energy).toFixed(2)
          							+ "<br>CO<sub>2</sub> Emission: "+ (co2conversion*metcalf[0].energy).toFixed(2) + " lbs")
               					.style("left", (d3.event.pageX + 5) + "px")
               					.style("top", (d3.event.pageY - 28) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
               		.on("click", function(d) {					//hide info on mouseout
          				newsvg("Metcalf");});
					
				svg.append("polyline")
					.attr("points", "338,207 398,207 398,242 338,242 ")
					.attr("style", "fill:black")
					.attr("id", "chapinbuilding")
					.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("Dorm: Chapin <br> Rank: "+getRank("chapin")+" <br> Energy Usage: " + (chapin[0].energy).toFixed(2) + " kwh"
          							+ "<br>Cost: $" + (moneyconversion*chapin[0].energy).toFixed(2)
          							+ "<br>CO<sub>2</sub> Emission: "+ (co2conversion*chapin[0].energy).toFixed(2) + " lbs")
               					.style("left", (d3.event.pageX + 5) + "px")
               					.style("top", (d3.event.pageY - 28) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
               		.on("click", function(d) {					//hide info on mouseout
          				newsvg("Chapin");});
					
				svg.append("polyline")
					.attr("points", "310,307 330,307 330,293 386,293 386,307 386,375 310,375 ")
					.attr("style", "fill:black")
					.attr("id", "emersonhallbuilding")
					.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("Dorm: Emerson Hall <br> Rank: "+getRank("emersonhall")+" <br> Energy Usage: " + (emersonhall[0].energy).toFixed(2) + " kwh"
          							+ "<br>Cost: $" + (moneyconversion*emersonhall[0].energy).toFixed(2)
          							+ "<br>CO<sub>2</sub> Emission: "+ (co2conversion*emersonhall[0].energy).toFixed(2) + " lbs")
               					.style("left", (d3.event.pageX + 5) + "px")
               					.style("top", (d3.event.pageY - 28) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
               		.on("click", function(d) {					//hide info on mouseout
          				newsvg("Emerson Hall");});
					
				svg.append("polyline")
					.attr("points", "305,375 345,375 345,481 305,481 ")
					.attr("style", "fill:black")
					.attr("id", "everettheightsbuilding")
					.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("Dorm: Everett Heights <br> Rank: "+getRank("everettheights")+" <br> Energy Usage: " + (everettheights[0].energy).toFixed(2) + " kwh"
          							+ "<br>Cost: $" + (moneyconversion*everettheights[0].energy).toFixed(2)
          							+ "<br>CO<sub>2</sub> Emission: "+ (co2conversion*everettheights[0].energy).toFixed(2) + " lbs")
               					.style("left", (d3.event.pageX + 5) + "px")
               					.style("top", (d3.event.pageY - 28) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
               		.on("click", function(d) {					//hide info on mouseout
          				newsvg("Everett Heights");});
					
				svg.append("polyline")
					.attr("points", "310,481 345,481 345,530 390,530 390,560 345,560 310,560 ")
					.attr("style", "fill:black")
					.attr("id", "everetthallbuilding")
					.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("Dorm: Everett Hall <br> Rank: "+getRank("everetthall")+" <br> Energy Usage: " + (everetthall[0].energy).toFixed(2) + " kwh"
          							+ "<br>Cost: $" + (moneyconversion*everetthall[0].energy).toFixed(2)
          							+ "<br>CO<sub>2</sub> Emission: "+ (co2conversion*everetthall[0].energy).toFixed(2) + " lbs")
               					.style("left", (d3.event.pageX + 5) + "px")
               					.style("top", (d3.event.pageY - 28) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
               		.on("click", function(d) {					//hide info on mouseout
          				newsvg("Everett Hall");});
				
				svg.append("polyline")
					.attr("points", "420,450 435,450 435,436 440,436 440,450 455,450 455,500 420,500 ")
					.attr("style", "fill:black")
					.attr("id", "craginbuilding")
					.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("Dorm: Cragin <br> Rank: "+getRank("cragin")+" <br> Energy Usage: " + (cragin[0].energy).toFixed(2) + " kwh"
          							+ "<br>Cost: $" + (moneyconversion*cragin[0].energy).toFixed(2)
          							+ "<br>CO<sub>2</sub> Emission: "+ (co2conversion*cragin[0].energy).toFixed(2) + " lbs")
               					.style("left", (d3.event.pageX + 5) + "px")
               					.style("top", (d3.event.pageY - 28) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
               		.on("click", function(d) {					//hide info on mouseout
          				newsvg("Cragin");});
					
				svg.append("polyline")
					.attr("points", "405,530 435,530 435,600 405,600 ")
					.attr("style", "fill:black")
					.attr("id", "stantonbuilding")
					.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("Dorm: Stanton <br> Rank: "+getRank("stanton")+" <br> Energy Usage: " + (stanton[0].energy).toFixed(2) + " kwh"
          							+ "<br>Cost: $" + (moneyconversion*stanton[0].energy).toFixed(2)
          							+ "<br>CO<sub>2</sub> Emission: "+ (co2conversion*stanton[0].energy).toFixed(2) + " lbs")
               					.style("left", (d3.event.pageX + 5) + "px")
               					.style("top", (d3.event.pageY - 28) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
               		.on("click", function(d) {					//hide info on mouseout
          				newsvg("Stanton");});
					
				svg.append("polyline")
					.attr("points", "345,650 420,650 420,695 345,695 ")
					.attr("style", "fill:black")
					.attr("id", "gebbiebuilding")
					.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("Dorm: Gebbie <br> Rank: "+getRank("gebbie")+" <br> Energy Usage: " + (gebbie[0].energy).toFixed(2) + " kwh"
          							+ "<br>Cost: $" + (moneyconversion*gebbie[0].energy).toFixed(2)
          							+ "<br>CO<sub>2</sub> Emission: "+ (co2conversion*gebbie[0].energy).toFixed(2) + " lbs")
               					.style("left", (d3.event.pageX + 5) + "px")
               					.style("top", (d3.event.pageY - 28) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
               		.on("click", function(d) {					//hide info on mouseout
          				newsvg("Gebbie");});
					
				svg.append("polyline")
					.attr("points", "300,697 343,697 343,765 300,765 ")
					.attr("style", "fill:black")
					.attr("id", "keefebuilding")
					.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("Dorm: Keefe <br> Rank: "+getRank("keefe")+" <br> Energy Usage: " + (keefe[0].energy).toFixed(2) + " kwh"
          							+ "<br>Cost: $" + (moneyconversion*keefe[0].energy).toFixed(2)
          							+ "<br>CO<sub>2</sub> Emission: "+ (co2conversion*keefe[0].energy).toFixed(2) + " lbs")
               					.style("left", (d3.event.pageX + 5) + "px")
               					.style("top", (d3.event.pageY - 28) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
               		.on("click", function(d) {					//hide info on mouseout
          				newsvg("Keefe");});
					
				svg.append("polyline")
					.attr("points", "210,860 313,860 313,900 210,900 ")
					.attr("style", "fill:black")
					.attr("id", "beardbuilding")
					.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("Dorm: Beard <br> Rank: "+getRank("beard")+" <br> Energy Usage: " + (beard[0].energy).toFixed(2) + " kwh"
          							+ "<br>Cost: $" + (moneyconversion*beard[0].energy).toFixed(2)
          							+ "<br>CO<sub>2</sub> Emission: "+ (co2conversion*beard[0].energy).toFixed(2) + " lbs")
               					.style("left", (d3.event.pageX + 5) + "px")
               					.style("top", (d3.event.pageY - 28) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
               		.on("click", function(d) {					//hide info on mouseout
          				newsvg("Beard");});
					
				svg.append("polyline")
					.attr("points", "1000,490 1040,490 1040,370 1145,370 1145,410 1080,410 1080,370 1080,490 1145,490 1145,535 1000,535 ")
					.attr("style", "fill:black")
					.attr("id", "meadowsbuilding")
					.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("Dorm: Meadows <br> Rank: "+getRank("meadows")+" <br> Energy Usage: " + (meadows[0].energy).toFixed(2) + " kwh"
          							+ "<br>Cost: $" + (moneyconversion*meadows[0].energy).toFixed(2)
          							+ "<br>CO<sub>2</sub> Emission: "+ (co2conversion*meadows[0].energy).toFixed(2) + " lbs")
               					.style("left", (d3.event.pageX + 5) + "px")
               					.style("top", (d3.event.pageY - 28) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
               		.on("click", function(d) {					//hide info on mouseout
          				newsvg("Meadows");});
					
				svg.append("polyline")
					.attr("points", "964,95 1005,95 1005,170 1025,170 1025,185 1005,185 964,185 ")
					.attr("style", "fill:black")
					.attr("id", "clarkbuilding")
					.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("Dorm: Clark <br> Rank: "+getRank("clark")+" <br> Energy Usage: " + (clark[0].energy).toFixed(2) + " kwh"
          							+ "<br>Cost: $" + (moneyconversion*clark[0].energy).toFixed(2)
          							+ "<br>CO<sub>2</sub> Emission: "+ (co2conversion*clark[0].energy).toFixed(2) + " lbs")
               					.style("left", (d3.event.pageX + 5) + "px")
               					.style("top", (d3.event.pageY - 28) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
               		.on("click", function(d) {					//hide info on mouseout
          				newsvg("Clark");});
               					
					
				svg.append("polyline")
					.attr("points", "1025,170 1070,170 1070,285 1025,285 ")
					.attr("style", "fill:black")
					.attr("id", "mcintirebuilding")
					.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("Dorm: McIntire <br> Rank: "+getRank("mcintire")+" <br> Energy Usage: " + (mcintire[0].energy).toFixed(2)+ " kwh"
          							+ "<br>Cost: $" + (moneyconversion*mcintire[0].energy).toFixed(2)
          							+ "<br>CO<sub>2</sub> Emission: "+ (co2conversion*mcintire[0].energy).toFixed(2) + " lbs")
               					.style("left", (d3.event.pageX + 5) + "px")
               					.style("top", (d3.event.pageY - 28) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
               		.on("click", function(d) {					//hide info on mouseout
          				newsvg("McIntire");});
					
				svg.append("polyline")
					.attr("points", "1070,170 1090,170 1090,95 1130,95 1130,195 1090,195 1090,185 1070,185 ")
					.attr("style", "fill:black")
					.attr("id", "youngbuilding")
					.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("Dorm: Young <br> Rank: "+getRank("young")+" <br> Energy Usage: " + (young[0].energy).toFixed(2) + " kwh"
          							+ "<br>Cost: $" + (moneyconversion*young[0].energy).toFixed(2)
          							+ "<br>CO<sub>2</sub> Emission: "+ (co2conversion*young[0].energy).toFixed(2) + " lbs")
               					.style("left", (d3.event.pageX + 5) + "px")
               					.style("top", (d3.event.pageY - 28) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
               		.on("click", function(d) {					//hide info on mouseout
          				newsvg("Young");});
          				
          				
          			svg.append("rect")
 					.attr("class", "loading")
 					.attr("fill", "#FFFFFF")
 					.attr("width", "210")
 					.attr("height", "130px")
 					.attr("x", 500)
 					.attr("y", 400);
 					
 					svg.append("text")
					.attr("font-size", "20px")
					.attr("x", 570)
					.attr("y", 430)
					.attr("fill", "black")
					.attr("class", "loading")
					.text("Loading...");
 					
 					svg.append("svg:image")
      				.attr("xlink:href", "blue-spinner.gif")
      				.attr("width", "7%")
      				.attr("height", "7%")
      				.attr("x",560)
      				.attr("y",450)
      				.attr("class", "loading");	

        	}
        	
        	function drawLabels()
        	{
        		svg.append("text")
					.attr("transform", "translate(327,130)rotate(270)")
					.attr("font-size", "12px")
					.attr("class", "label")
					.text("Kilham");
				
				svg.append("text")
					.attr("transform", "translate(428,130)rotate(270)")
					.attr("font-size", "12px")
					.attr("class", "label")
					.text("Metcalf");
				
				svg.append("text")
					.attr("transform", "translate(349,228)rotate(0)")
					.attr("font-size", "12px")
					.attr("class", "label")
					.text("Chapin");
					
				svg.append("text")
					.attr("transform", "translate(406,280)rotate(0)")
					.attr("font-size", "12px")
					.attr("class", "label")
					.text("Larcom");
					
				svg.append("text")
					.attr("transform", "translate(325,337)rotate(0)")
					.attr("font-size", "12px")
					.attr("class", "label")
					.text("Emerson");
				svg.append("text")
					.attr("transform", "translate(340,350)rotate(0)")
					.attr("font-size", "12px")
					.attr("class", "label")
					.text("Hall");
				
				svg.append("text")
					.attr("transform", "translate(322,450)rotate(270)")
					.attr("font-size", "12px")
					.attr("class", "label")
					.text("Everett");
				svg.append("text")
					.attr("transform", "translate(334,452)rotate(270)")
					.attr("font-size", "12px")
					.attr("class", "label")
					.text("Heights");
					
				svg.append("text")
					.attr("transform", "translate(330,543)rotate(0)")
					.attr("font-size", "12px")
					.attr("class", "label")
					.text("Everett");
				svg.append("text")
					.attr("transform", "translate(340,553)rotate(0)")
					.attr("font-size", "12px")
					.attr("class", "label")
					.text("Hall");
					
				svg.append("text")
					.attr("transform", "translate(420,480)rotate(0)")
					.attr("font-size", "12px")
					.attr("class", "label")
					.text("Cragin");
					
				svg.append("text")
					.attr("transform", "translate(423,587)rotate(270)")
					.attr("font-size", "12px")
					.attr("class", "label")
					.text("Stanton");
				
				svg.append("text")
					.attr("transform", "translate(362,677)rotate(0)")
					.attr("font-size", "12px")
					.attr("class", "label")
					.text("Gebbie");
					
				svg.append("text")
					.attr("transform", "translate(325,747)rotate(270)")
					.attr("font-size", "12px")
					.attr("class", "label")
					.text("Keefe");
					
				svg.append("text")
					.attr("transform", "translate(245,883)rotate(0)")
					.attr("font-size", "12px")
					.attr("class", "label")
					.text("Beard");
					
				svg.append("text")
					.attr("transform", "translate(1045,516)rotate(0)")
					.attr("font-size", "12px")
					.attr("class", "label")
					.text("Meadows");
					
				svg.append("text")
					.attr("transform", "translate(988,157)rotate(270)")
					.attr("font-size", "12px")
					.attr("class", "label")
					.text("Clark");
					
				svg.append("text")
					.attr("transform", "translate(1052,245)rotate(270)")
					.attr("font-size", "12px")
					.attr("class", "label")
					.text("McIntire");
					
				svg.append("text")
					.attr("transform", "translate(1113,157)rotate(270)")
					.attr("font-size", "12px")
					.attr("class", "label")
					.text("Young");
			}
        	
        	larcom = [];
        	numlarcom = 63;
        	kilham = [];
        	numkilham = 58;
        	metcalf = [];
        	nummetcalf = 65;
        	chapin = [];
        	numchapin = 45;
        	emersonhall = [];
        	numemersonhall = 28;
        	everettheights = [];
        	numeverettheights = 17
        	everetthall = [];
        	numeveretthall = 174;
        	cragin = [];
        	numcragin = 68;
        	stanton = [];
        	numstanton = 88;
        	gebbie = [];
        	numgebbie = 50;
        	keefe = [];
        	numkeefe = 50;
        	beard = [];
        	numbeard = 110;
        	meadows = [];
        	nummeadows = 280;
        	clark = [];
        	numclark = 96;
        	mcintire = [];
        	nummcintire = 92;
        	young = [];
        	numyoung = 94;
        	
        	larcomDorm = [];
        	larcomComp = [];
        	kilham1 = [];
        	kilham2 = [];
        	emersonA = [];
        	emersonB = [];
        	stantonDorm = [];
        	stantonComp = [];
        	StantonCraginEverett = [];
        	gebbieKeefe = [];
        	ymcCombined = [];
        	
        	secondsinday = 86400;
        	secondsinweek = secondsinday*7;
        	secondsinmonth = secondsinweek*4;
        	secondsinyear = secondsinmonth*12;
        	
        	numticks = 5;
        	
        	oneday = true;
        	oneweek = false;
        	onemonth = false;
        	oneyear = true;
        	
        	
        	var recenttime;
        	var svg2;
        	var svg;
        	
        	var dorms = ["http://cs.wheatonma.edu/~egauge/beard/beard.xml", "http://cs.wheatonma.edu/~egauge/chapin/chapin.xml", "http://cs.wheatonma.edu/~egauge/clark-mcintire-young/clark-mcintire-young.xml", "http://cs.wheatonma.edu/~egauge/emerson-dorm/emerson-dorm.xml", "http://cs.wheatonma.edu/~egauge/everett-heights/everett-heights.xml", "http://cs.wheatonma.edu/~egauge/gebbie-keefe/gebbie-keefe.xml", /*"http://cs.wheatonma.edu/~egauge/kilham/kilham.xml",*/ "http://cs.wheatonma.edu/~egauge/larcom/larcom.xml", "http://cs.wheatonma.edu/~egauge/meadows-ew-1st-floor/meadows-ew-1st-floor.xml", "http://cs.wheatonma.edu/~egauge/meadows-ew-2nd-floor/meadows-ew-2nd-floor.xml", "http://cs.wheatonma.edu/~egauge/meadows-ew-3rd-floor/meadows-ew-3rd-floor.xml", "http://cs.wheatonma.edu/~egauge/meadows-ew-4th-floor/meadows-ew-4th-floor.xml", "http://cs.wheatonma.edu/~egauge/meadows-north-1st-floor/meadows-north-1st-floor.xml", "http://cs.wheatonma.edu/~egauge/meadows-north-2nd-floor/meadows-north-2nd-floor.xml", "http://cs.wheatonma.edu/~egauge/meadows-north-3rd-floor/meadows-north-3rd-floor.xml", "http://cs.wheatonma.edu/~egauge/meadows-north-4th-floor/meadows-north-4th-floor.xml", "http://cs.wheatonma.edu/~egauge/metcalf/metcalf.xml", "http://cs.wheatonma.edu/~egauge/stanton-cragin-everett/stanton-cragin-everett.xml", "http://cs.wheatonma.edu/~egauge/kilham/kilham.xml"]; 
        	
        	redgreen = ["#FF0000", "#FF2100", "#FF4400", "#FF6600", "#FF8800", "#FFAA00", "#FFCC00", "#FFEE00",
        				"#EDFF00", "#CBFF00", "#A9FF00", "#87FF00", "#65FF00", "#43FF00", "#21FF00", "#00FF00"];
        	blueyell = ["#0000FF", "#1111EE", "#2222DD", "#3333CC", "#4444BB", "#5555AA", "#666699", "#777788",
        				"#888877", "#999966", "#AAAA55", "#BBBB44", "#CCCC33", "#DDDD22", "#EEEE11", "#FFFF00"];
        	texture = ["url(#pattern1)", "url(#pattern2)", "url(#pattern3)", "url(#pattern4)", "url(#pattern5)", "url(#pattern6)", "url(#pattern7)", "url(#pattern8)",
        				"url(#pattern9)", "url(#pattern10)", "url(#pattern11)", "url(#pattern12)", "url(#pattern13)", "url(#pattern14)", "url(#pattern15)", "url(#pattern16)"];
        	dormcolors = ["#cc0000", "#800000", "#ffa500", "#ffff00", 
        				"#008000", "#a0db8e", "#000080", "#3399ff", 
        				"#8a2be2", "#660066", "#ffc0cb", "#f6546a",
        				"#999999", "#008080", "#7A5230", "#ffc3a0"]
        	recent = [];
        	redgrad = true;
        	bluegrad = false;
        	textgrad = false;
        	
        	averageon = false;
        	goalon = false;
        	baseon = false;
        	
        	compareschools = false;
        	comparebuildings = false;
        	
        	goal = 400;
        	base = 10;
        	
        	currentdorm = ""
        	
        	showlarcom = false;
        	showkilham = false;
        	showmetcalf = false;
        	showchapin = false;
        	showemersonhall = false;
        	showeverettheights = false;
        	showeveretthall = false;
        	showcragin = false;
        	showstanton= false;
        	showgebbie = false;
        	showkeefe = false;
        	showbeard = false;
        	showmeadows = false;
        	showclark = false;
        	showmcintire = false;
        	showyoung = false;
        	
        	showlabels = false;
        	
        	converttomoney = false;
        	converttoco2 = false;
        	maxDate = 0;
        	minDate = 0;
        	
        	moneyconversion = .14;
        	co2conversion = 0.6379;
        	
        	maxy = 0;
        	
        	mywindow = 0;
        	
        	function getTitlePosition(name)
        	{
        		if(name == "Larcom")
        			return 480;
        		if(name == "Kilham")
        			return 480;
        		if(name == "Metcalf")
        			return 480;
        		if(name == "Chapin")
        			return 480;
        		if(name == "Emerson Hall")
        			return 410;
        		if(name == "Everett Heights")
        			return 370;
        		if(name == "Everett Hall")
        			return 410;
        		if(name == "Cragin")
        			return 480;
        		if(name == "Stanton")
        			return 480;
        		if(name == "Gebbie")
        			return 480;
        		if(name == "Keefe")
        			return 480;
        		if(name == "Beard")
        			return 480;
        		if(name == "Meadows")
        			return 480;
        		if(name == "Clark")
        			return 480;
        		if(name == "McIntire")
        			return 480;
        		if(name == "Young")
        			return 480;
        		else
        			return 0;
        	}
        	
        	function getDataToUse(name)
        	{
        		if(name == "Larcom")
        			return larcom;
        		if(name == "Kilham")
        			return kilham;
        		if(name == "Metcalf")
        			return metcalf;
        		if(name == "Chapin")
        			return chapin;
        		if(name == "Emerson Hall")
        			return emersonhall;
        		if(name == "Everett Heights")
        			return everettheights;
        		if(name == "Everett Hall")
        			return everetthall;
        		if(name == "Cragin")
        			return cragin;
        		if(name == "Stanton")
        			return cragin;
        		if(name == "Gebbie")
        			return gebbie;
        		if(name == "Keefe")
        			return keefe;
        		if(name == "Beard")
        			return beard;
        		if(name == "Meadows")
        			return meadows;
        		if(name == "Clark")
        			return clark;
        		if(name == "McIntire")
        			return mcintire;
        		if(name == "Young")
        			return young;
        		else
        			return [];
        	}
        	
        	function getClass(name)
        	{
        		var classname = "pop ";
        		if(name == "Larcom")
        			return classname + "larcom";
        		if(name == "Kilham")
        			return classname + "kilham";
        		if(name == "Metcalf")
        			return classname + "metcalf";
        		if(name == "Chapin")
        			return classname + "chapin";
        		if(name == "Emerson Hall")
        			return classname + "emersonhall";
        		if(name == "Everett Heights")
        			return classname + "everettheights";
        		if(name == "Everett Hall")
        			return classname + "everetthall";
        		if(name == "Cragin")
        			return classname + "cragin";
        		if(name == "Stanton")
        			return classname + "stanton";
        		if(name == "Gebbie")
        			return classname + "gebbie";
        		if(name == "Keefe")
        			return classname + "keefe";
        		if(name == "Beard")
        			return classname + "beard";
        		if(name == "Meadows")
        			return classname + "meadows";
        		if(name == "Clark")
        			return classname + "clark";
        		if(name == "McIntire")
        			return classname + "mcintire";
        		if(name == "Young")
        			return classname + "young";
        		else
        			return classname;
        	}
        	        	 
        	function newsvg(name)
        	{
        		data = getDataToUse(name);
        		
        		maxy = getMaxY();
        		svg2 = d3.select("#mainsvg").append("g");
        		currentdorm = name;
        		svg.append("rect")
					.attr("class", "pop")
					.attr("width", 1030)
					.attr("height", 650)
					.attr("stroke", "#373737")
					.attr("stroke-width", 3)
					.attr("y", 100)
					.attr("x", 70)
					.attr("id", "mainrect")
					.attr("fill", "#0C6268");
        		
        		svg2.append("text")
        					.attr("x", function(){return getTitlePosition(name);} )
							.attr("y", 200)
							.attr("font-size", "60px")
							.attr("fill", "#F4E3E3")
							.attr("class", "pop")
							.text(name);
							
				svg.append("svg:image")
      				.attr("xlink:href", "envX.svg")
      				.attr("width", "50px")
      				.attr("class", "pop")
      				.attr("height", "50px")
      				.attr("x", 1040)
      				.attr("y", 110)
      				.on("click", function(){clearPopUp()})
      				.attr("id", "close");
      				
      			svg.append("rect")
					.attr("class", "pop")
					.attr("width", 630)
					.attr("height", 430)
					.attr("stroke", "#373737")
					.attr("stroke-width", 1)
					.attr("y", 260)
					.attr("x", 110)
					.attr("fill", "#FFFFFF");
					
				svg.append("rect")
					.attr("class", "pop")
					.attr("width", 150)
					.attr("height", 100)
					.attr("stroke", "#373737")
					.attr("stroke-width", 1)
					.attr("y", 240)
					.attr("x", 850)
					.attr("fill", "#31AC8B");
					
				svg2.append("text")
        					.attr("x", 822 )
							.attr("y", 230)
							.attr("font-size", "18px")
							.attr("class", "pop")
							.attr("fill", "black")
							.attr("fill", "#F4E3E3")
							.text("Current Energy Usage (kwh):");
							
				svg2.append("text")
        					.attr("x", 860 )
							.attr("y", 310)
							.attr("font-size", "50px")
							.attr("class", "pop")
							.attr("fill", "white")
							.text(function(){return (data[0].energy).toFixed(1);});

							
				svg2.append("text")
					.attr("transform", "translate(130,490)rotate(270)")
					.attr("font-size", "18px")
					.attr("id", "yaxislabel")
					.attr("class", "pop")
					.text("kwh");
							
				svg.append("svg:image")
      				.attr("xlink:href", "envFly.svg")
      				.attr("width", "50px")
      				.attr("class", "pop")
      				.attr("height", "50px")
      				.attr("x", 780)
      				.attr("y", 702);
      				
      			svg.append("svg:image")
      				.attr("xlink:href", "envFly.svg")
      				.attr("width", "50px")
      				.attr("class", "pop")
      				.attr("height", "50px")
      				.attr("x", 1028)
      				.attr("y", 702);
   
						WIDTH = 600,
						HEIGHT = 400,
						MARGINS = {
						  top: 20,
						  right: 20,
						  bottom: 20,
						  left: 50
						};
						maxDate = recenttime;
						if(oneday)
						{
							minDate = maxDate-secondsinday;
						}
						else if(oneweek)
						{
							minDate = maxDate-secondsinweek;
						}
						else if(onemonth)
						{
							minDate = maxDate-secondsinmonth;
						}
						else if(oneyear)
						{
							minDate = maxDate-secondsinyear;
						}
    					
    					data = data.filter(function (el) 
    					{
    						return el.time <= maxDate && el.time>=minDate;
						});
					   xRange = d3.time.scale().domain([new Date(minDate*1000), new Date(maxDate*1000)]).range([MARGINS.left, WIDTH - MARGINS.right]),
					
    
						yRange = d3.scale.linear().range([HEIGHT - MARGINS.top, MARGINS.bottom]).domain([0, maxy]),
    
						xAxis = d3.svg.axis()
						  .scale(xRange)
						  .tickSize(5)
						  .ticks(numticks),
	  
						yAxis = d3.svg.axis()
						  .scale(yRange)
						  .tickSize(5)
						  .orient('left')
						  .tickSubdivide(true);
	  
						  svg.append('svg:g')
					  .attr('class', 'pop')
					  .attr('id', 'xaxis')
					  .attr('transform', 'translate(130,' + (HEIGHT - MARGINS.bottom +260) + ')')
					  .call(xAxis);

					svg.append('svg:g')
					  .attr('class', 'pop')
					  .attr('id', 'yaxis')
					  .attr('transform', 'translate(' + (130+MARGINS.left) + ',260)')
					  .call(yAxis);
  
					  var lineFunc = d3.svg.line()
					  .x(function(d) {
						return xRange(new Date(1000*d.time));
					  })
					  .y(function(d) {
						return yRange(d.energy);
					  })
					  .interpolate('linear');
  
					  svg.append('svg:path')
					  .attr('d', lineFunc(data))
					  .attr('stroke', 'black')
					  .attr('stroke-width', 2)
					  .attr("class", function(){return getClass(name);})
					  .attr('transform', 'translate(130,260)')
					  .on("mouseover", function() {					//display info on mouseover
											tooltip.transition()
													.duration(200)
													.style("opacity", .9);
											tooltip.html(name)
													.style("left", (d3.event.pageX+4) + "px")
													.style("top", (d3.event.pageY+4) + "px");
											})
										.on("mouseout", function(d) {					//hide info on mouseout
											tooltip.transition()
													.duration(500)
													.style("opacity", 0);})
					  .attr('fill', 'none');
  
  
  						svg2.append("foreignObject")
						.attr("width", 480)
						.attr("height", 500)
						.attr("x", 780 )
						.attr("y", 350 )
						.attr("class", "pop")
						.html("<form id='check' style='z-index:2;' action='demo_form.asp' method='get'>"+
				"<label><input type='checkbox' class='check1' style='z-index:3;' id='averageline' value='' onchange='showAverage()'>Show average</label><br><br>" +
  				"<label><input type='checkbox' class='check1' style='z-index:3;'id='goalline' value='' onchange='showGoal()'>Show goal line</label><br><br>"+
  				"<label><input type='checkbox' class='check1' style='z-index:3;'id='baseline' value='' onchange='showBase()'>Show base line</label><br><br>" +
  				"<label><input type='checkbox' class='check1' style='z-index:3;'id='money' value='' onchange='displayMoney()'>Display in terms of money</label><br><br>"+
  				"<label><input type='checkbox' class='check1' style='z-index:3;'id='co' value='' onchange='displayCO()'>Display in terms of CO<sub>2</sub> emission</label><br><br>"+
  				"</form>"
  				
  				 + "<p style='position:relative;top:-20px;left:0px;width:100px;'> Compare to: </p>"
  				// 
//   				+ "<form id='radio'action='' style='position:relative;top:0px;left:-100px;'>"
//   				+ "<input type='radio' name='radiobutton' id='buildings' value='1'> Other buildings &nbsp;"
//   				+ "<input type='radio' name='radiobutton' id='schools' value='2'> Other schools<br>"
// 				+"</form>"
				
				
				+"<div id='ScrollCB'>" 
				+"<input type='checkbox' id='graphlarcom' onchange='showLarcom()' value='1'>Larcom<br> "
				+"<input type='checkbox' id='graphkilham' onchange='showKilham()' value='2'>Kilham<br>" 
				+"<input type='checkbox' id='graphmetcalf' onchange='showMetcalf()' value='3'>Metcalf<br>"
				+"<input type='checkbox' id='graphchapin' onchange='showChapin()' value='4'>Chapin<br> "
				+"<input type='checkbox' id='graphemersonhall' onchange='showEmersonHall()' value='5'>Emerson Hall<br> "
				+"<input type='checkbox' id='grapheverettheights' onchange='showEverettHeights()' value='6'>Everett Heights<br> "
				+"<input type='checkbox' id='grapheveretthall' onchange='showEverettHall()' value='7'>Everett Hall<br> "
				+"<input type='checkbox' id='graphcragin' onchange='showCragin()' value='8'>Cragin<br> "
				+"<input type='checkbox' id='graphstanton' onchange='showStanton()' value='9'>Stanton<br> "
				+"<input type='checkbox' id='graphgebbie' onchange='showGebbie()' value='10'>Gebbie<br> "
				+"<input type='checkbox' id='graphkeefe' onchange='showKeefe()' value='11'>Keefe<br> "
				+"<input type='checkbox' id='graphbeard' onchange='showBeard()' value='12'>Beard<br> "
				+"<input type='checkbox' id='graphmeadows' onchange='showMeadows()' value='13'>Meadows<br> "
				+"<input type='checkbox' id='graphclark' onchange='showClark()' value='14'>Clark<br> "
				+"<input type='checkbox' id='graphmcintire' onchange='showMcintire()' value='15'>McIntire<br> "
				+"<input type='checkbox' id='graphyoung' onchange='showYoung()' value='16'>Young<br> "
				+"</div> "
// 				
// 				+ "<form style='padding-left:40px;' action='form_action.asp'>"
// 				+ "<select name='cars' multiple>"
// 				+ "<option value='volvo'>Hamilton College</option>"
// 				+ "<option value='volvo'>Skidmore College</option>"
// 				+ "<option value='volvo'>Amherst College</option>"
// 				+ "<option value='volvo'>Vassar College</option>"
// 				+ "</select></form></div>"
				
				+ "<button style='position:relative;left:-100px;' type='button' onclick='reset()'>Reset</button>"
				+ "<br><a style='font-size:14px;position:relative;left:-100px;top:0px;' href='tips.html' target='_blank'>Tips for reducing energy consumption</a>"
);

				svg2.append("foreignObject")
						.attr("width", 480)
						.attr("height", 500)
						.attr("x", 200 )
						.attr("y", 665 )
						.attr("class", "pop")
						.html("<select id='xaxisscale' autocomplete='off' onchange='changexscale()'>"
				+"<option value=day>One Day</option>"
				+"<option value=week>One Week</option>"
				+"<option value=month>One Month</option>"
				+"<option value=year>One Year</option>"
				+"<option value=other>Other</option>"
				+"</select>");
				
				str = currentdorm.replace(/\s+/g, '');
         		str = "graph"+str.toLowerCase();
         		document.getElementById(str).checked = true;
				
        	}
        	
        	function displayMoney()
        	{
        		converttomoney = !converttomoney;
        		var mult =1;
        		if(converttomoney)
        		{
        			converttoco2 = false;
        			document.getElementById("co").checked = false;
        			mult = moneyconversion;
        			
        			d3.selectAll("#yaxislabel").remove();
        			svg2.append("text")
					.attr("transform", "translate(130,490)rotate(270)")
					.attr("font-size", "18px")
					.attr("id", "yaxislabel")
					.attr("class", "pop")
					.text("dollars");
        			
        		}
        		else
        		{
        			d3.selectAll("#yaxislabel").remove();
        			svg2.append("text")
					.attr("transform", "translate(130,490)rotate(270)")
					.attr("font-size", "18px")
					.attr("id", "yaxislabel")
					.attr("class", "pop")
					.text("kwh");
				}
        		
        		yRange2 = d3.scale.linear().range([HEIGHT - MARGINS.top, MARGINS.bottom]).domain([0, mult*maxy]),
				d3.selectAll("#yaxis").remove();
	  
				yAxis = d3.svg.axis()
				  .scale(yRange2)
				  .tickSize(5)
				  .orient('left')
				  .tickSubdivide(true);
	  

				svg.append('svg:g')
				  .attr('class', 'pop')
				  .attr('id', 'yaxis')
				  .attr('transform', 'translate(' + (130+MARGINS.left) + ',260)')
				  .call(yAxis);
        	}
        	
        	function displayCO()
        	{
        		converttoco2 = !converttoco2;
        		var mult =1;
        		if(converttoco2)
        		{
        			converttomoney = false;
        			document.getElementById("money").checked = false;
        			mult = co2conversion;
        			
        			d3.selectAll("#yaxislabel").remove();
        			svg2.append("text")
					.attr("transform", "translate(130,490)rotate(270)")
					.attr("font-size", "18px")
					.attr("id", "yaxislabel")
					.attr("class", "pop")
					.text("lbs of CO2");
        		}
        		else
        		{
        			d3.selectAll("#yaxislabel").remove();
        			svg2.append("text")
					.attr("transform", "translate(130,490)rotate(270)")
					.attr("font-size", "18px")
					.attr("id", "yaxislabel")
					.attr("class", "pop")
					.text("kwh");
				}
        		yRange2 = d3.scale.linear().range([HEIGHT - MARGINS.top, MARGINS.bottom]).domain([0, mult*maxy]),
				d3.selectAll("#yaxis").remove();
	  
				yAxis = d3.svg.axis()
				  .scale(yRange2)
				  .tickSize(5)
				  .orient('left')
				  .tickSubdivide(true);
	  

				svg.append('svg:g')
				  .attr('class', 'pop')
				  .attr('id', 'yaxis')
				  .attr('transform', 'translate(' + (130+MARGINS.left) + ',260)')
				  .call(yAxis);
        	}
        	
        	function callCalendar()
        	{
        		mywindow = window.open("calendar.html", "_blank", "toolbar=yes,scrollbars=yes,resizable=yes,top=300,left=300,width=500,height=200");
        		
        	}
        	
        	function regraph()
        	{
        		str = currentdorm.replace(/\s+/g, '');
        		str = str.toLowerCase()
        		d3.selectAll("."+str).remove();
        		d3.selectAll("#xaxis").remove();
        		data = getDataToUse(currentdorm);
        		
        		
        		
        		data = data.filter(function (el) 
				{
					return el.time <= maxDate && el.time>=minDate;
				});
			   xRange = d3.time.scale().domain([new Date(minDate*1000), new Date(maxDate*1000)]).range([MARGINS.left, WIDTH - MARGINS.right]),
				
				 xAxis = d3.svg.axis()
				  .scale(xRange)
				  .tickSize(numticks)
				  .ticks(numticks);
				
				svg.append('svg:g')
				  .attr('class', 'pop')
				  .attr('id', 'xaxis')
				  .attr('transform', 'translate(130,' + (HEIGHT - MARGINS.bottom +260) + ')')
				  .call(xAxis);
				  
				  var lineFunc = d3.svg.line()
					  .x(function(d) {
						return xRange(new Date(1000*d.time));
					  })
					  .y(function(d) {
						return yRange(d.energy);
					  })
					  .interpolate('linear');
  
					  svg.append('svg:path')
					  .attr('d', lineFunc(data))
					  .attr('stroke', 'black')
					  .attr('stroke-width', 2)
					  .attr("class", function(){return getClass(currentdorm);})
					  .attr('transform', 'translate(130,260)')
					  .on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html(currentdorm)
               					.style("left", (d3.event.pageX+4) + "px")
               					.style("top", (d3.event.pageY+4) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
  .attr('fill', 'none');
  
  
  				if(currentdorm != "Stanton")
        		{
        			d3.selectAll(".stanton").remove();
        			if(showstanton)
        			{
        				var lineFunc = d3.svg.line()
							.x(function(d) {
							return xRange(new Date(1000*d.time));
							})
							.y(function(d) {
							return yRange(d.energy);
							})
							.interpolate('linear');
						
						data = stanton.filter(function (el) 
    					{
    						return el.time <= maxDate&& el.time>=minDate;
						});

							svg.append('svg:path')
							.attr('d', lineFunc(data))
							.attr('stroke', dormcolors[9])
							.style("stroke-opacity", 0.3)
							.attr('stroke-width', 2)
							.attr("class", "pop stanton")
							.attr('transform', 'translate(130,260)')
							.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("Stanton")
               					.style("left", (d3.event.pageX+4) + "px")
               					.style("top", (d3.event.pageY+4) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
							.attr('fill', 'none')
					.on("click", function(d) {
						clearPopUp();
						newsvg("Stanton");
					});
					}
        		}
        		if(currentdorm != "Larcom")
        		{
        			d3.selectAll(".larcom").remove();
        			if(showlarcom)
        			{
        				var lineFunc = d3.svg.line()
							.x(function(d) {
							return xRange(new Date(1000*d.time));
							})
							.y(function(d) {
							return yRange(d.energy);
							})
							.interpolate('linear');
							
							data = larcom.filter(function (el) 
    					{
    						return el.time <= maxDate&& el.time>=minDate;
						});
							
							svg.append('svg:path')
							.attr('d', lineFunc(data))
							.attr('stroke', dormcolors[0])
							.attr('stroke-width', 2)
							.attr("class", "pop larcom")
							.style("stroke-opacity", 0.3)
							.attr('transform', 'translate(130,260)')
							.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("Larcom")
               					.style("left", (d3.event.pageX+4) + "px")
               					.style("top", (d3.event.pageY+4) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
							.attr('fill', 'none')
					.on("click", function(d) {
						clearPopUp();
						newsvg("Larcom");
					});
					}
        		}
        		if(currentdorm != "Kilham")
        		{
        			d3.selectAll(".kilham").remove();
        			if(showkilham)
        			{
        				var lineFunc = d3.svg.line()
							.x(function(d) {
							return xRange(new Date(1000*d.time));
							})
							.y(function(d) {
							return yRange(d.energy);
							})
							.interpolate('linear');
							
						data = kilham.filter(function (el) 
    					{
    						return el.time <= maxDate && el.time>=minDate;
						});



							svg.append('svg:path')
							.attr('d', lineFunc(data))
							.attr('stroke', dormcolors[1])
							.style("stroke-opacity", 0.3)
							.attr('stroke-width', 2)
							.attr("class", "pop kilham")
							.attr('transform', 'translate(130,260)')
							.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("Kilham")
               					.style("left", (d3.event.pageX+4) + "px")
               					.style("top", (d3.event.pageY+4) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
							.attr('fill', 'none')
					.on("click", function(d) {
						clearPopUp();
						newsvg("Kilham");
					});
					}
        		}
        		if(currentdorm != "Metcalf")
        		{
        			d3.selectAll(".metcalf").remove();
        			if(showmetcalf)
        			{
        				var lineFunc = d3.svg.line()
							.x(function(d) {
							return xRange(new Date(1000*d.time));
							})
							.y(function(d) {
							return yRange(d.energy);
							})
							.interpolate('linear');
							
						data = metcalf.filter(function (el) 
    					{
    						return el.time <= maxDate&& el.time>=minDate;
						});

							svg.append('svg:path')
							.attr('d', lineFunc(data))
							.attr('stroke', dormcolors[2])
							.style("stroke-opacity", 0.3)
							.attr('stroke-width', 2)
							.attr("class", "pop metcalf")
							.attr('transform', 'translate(130,260)')
							.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("Metcalf")
               					.style("left", (d3.event.pageX+4) + "px")
               					.style("top", (d3.event.pageY+4) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
							.attr('fill', 'none')
					.on("click", function(d) {
						clearPopUp();
						newsvg("Metcalf");
					});
					}
        		}
        		if(currentdorm != "Chapin")
        		{
        			d3.selectAll(".chapin").remove();
        			if(showchapin)
        			{
        				var lineFunc = d3.svg.line()
							.x(function(d) {
							return xRange(new Date(1000*d.time));
							})
							.y(function(d) {
							return yRange(d.energy);
							})
							.interpolate('linear');
						
						data = chapin.filter(function (el) 
    					{
    						return el.time <= maxDate&& el.time>=minDate;
						});

							svg.append('svg:path')
							.attr('d', lineFunc(data))
							.attr('stroke', dormcolors[3])
							.style("stroke-opacity", 0.3)
							.attr('stroke-width', 2)
							.attr("class", "pop chapin")
							.attr('transform', 'translate(130,260)')
							.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("Chapin")
               					.style("left", (d3.event.pageX+4) + "px")
               					.style("top", (d3.event.pageY+4) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
							.attr('fill', 'none')
					.on("click", function(d) {
						clearPopUp();
						newsvg("Chapin");
					});
					}
        		}
        		if(currentdorm != "Emerson Hall")
        		{
        			d3.selectAll(".emersonhall").remove();
        			if(showemersonhall)
        			{
        				var lineFunc = d3.svg.line()
							.x(function(d) {
							return xRange(new Date(1000*d.time));
							})
							.y(function(d) {
							return yRange(d.energy);
							})
							.interpolate('linear');
							
						data = emersonhall.filter(function (el) 
    					{
    						return el.time <= maxDate&& el.time>=minDate;
						});

							svg.append('svg:path')
							.attr('d', lineFunc(data))
							.attr('stroke', dormcolors[4])
							.style("stroke-opacity", 0.3)
							.attr('stroke-width', 2)
							.attr("class", "pop emersonhall")
							.attr('transform', 'translate(130,260)')
							.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("Emerson Hall")
               					.style("left", (d3.event.pageX+4) + "px")
               					.style("top", (d3.event.pageY+4) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
							.attr('fill', 'none')
					.on("click", function(d) {
						clearPopUp();
						newsvg("Emerson Hall");
					});
					}
        		}
        		if(currentdorm != "Everett Heights")
        		{
        			d3.selectAll(".everettheights").remove();
        			if(showeverettheights)
        			{
        				var lineFunc = d3.svg.line()
							.x(function(d) {
							return xRange(new Date(1000*d.time));
							})
							.y(function(d) {
							return yRange(d.energy);
							})
							.interpolate('linear');
							
						data = everettheights.filter(function (el) 
    					{
    						return el.time <= maxDate&& el.time>=minDate;
						});

							svg.append('svg:path')
							.attr('d', lineFunc(data))
							.attr('stroke', dormcolors[5])
							.style("stroke-opacity", 0.3)
							.attr('stroke-width', 2)
							.attr("class", "pop everettheights")
							.attr('transform', 'translate(130,260)')
							.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("Everett Heights")
               					.style("left", (d3.event.pageX+4) + "px")
               					.style("top", (d3.event.pageY+4) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
							.attr('fill', 'none')
					.on("click", function(d) {
						clearPopUp();
						newsvg("Everett Heights");
					});
					}
        		}
        		if(currentdorm != "Everett Hall")
        		{
        			d3.selectAll(".everetthall").remove();
        			if(showeveretthall)
        			{
        				var lineFunc = d3.svg.line()
							.x(function(d) {
							return xRange(new Date(1000*d.time));
							})
							.y(function(d) {
							return yRange(d.energy);
							})
							.interpolate('linear');
							
						data = everetthall.filter(function (el) 
    					{
    						return el.time <= maxDate&& el.time>=minDate;
						});

							svg.append('svg:path')
							.attr('d', lineFunc(data))
							.attr('stroke', dormcolors[6])
							.style("stroke-opacity", 0.3)
							.attr('stroke-width', 2)
							.attr("class", "pop everetthall")
							.attr('transform', 'translate(130,260)')
							.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("Everett Hall")
               					.style("left", (d3.event.pageX+4) + "px")
               					.style("top", (d3.event.pageY+4) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
							.attr('fill', 'none')
					.on("click", function(d) {
						clearPopUp();
						newsvg("Everett Hall");
					});
					}
        		}
        		if(currentdorm != "Cragin")
        		{
        			d3.selectAll(".cragin").remove();
        			if(showcragin)
        			{
        				var lineFunc = d3.svg.line()
							.x(function(d) {
							return xRange(new Date(1000*d.time));
							})
							.y(function(d) {
							return yRange(d.energy);
							})
							.interpolate('linear');
							
						data = cragin.filter(function (el) 
    					{
    						return el.time <= maxDate&& el.time>=minDate;
						});

							svg.append('svg:path')
							.attr('d', lineFunc(data))
							.attr('stroke', dormcolors[7])
							.style("stroke-opacity", 0.3)
							.attr('stroke-width', 2)
							.attr("class", "pop cragin")
							.attr('transform', 'translate(130,260)')
							.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("Cragin")
               					.style("left", (d3.event.pageX+4) + "px")
               					.style("top", (d3.event.pageY+4) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
							.attr('fill', 'none')
					.on("click", function(d) {
						clearPopUp();
						newsvg("Cragin");
					});
					}
        		}
        		if(currentdorm != "Gebbie")
        		{
        			d3.selectAll(".gebbie").remove();
        			if(showgebbie)
        			{
        				var lineFunc = d3.svg.line()
							.x(function(d) {
							return xRange(new Date(1000*d.time));
							})
							.y(function(d) {
							return yRange(d.energy);
							})
							.interpolate('linear');
							
						data = gebbie.filter(function (el) 
    					{
    						return el.time <= maxDate&& el.time>=minDate;
						});

							svg.append('svg:path')
							.attr('d', lineFunc(data))
							.attr('stroke', dormcolors[8])
							.style("stroke-opacity", 0.3)
							.attr('stroke-width', 2)
							.attr("class", "pop gebbie")
							.attr('transform', 'translate(130,260)')
							.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("Gebbie")
               					.style("left", (d3.event.pageX+4) + "px")
               					.style("top", (d3.event.pageY+4) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
							.attr('fill', 'none')
					.on("click", function(d) {
						clearPopUp();
						newsvg("Gebbie");
					});
					}
        		}
        		if(currentdorm != "Keefe")
        		{
        			d3.selectAll(".keefe").remove();
        			if(showkeefe)
        			{
        				var lineFunc = d3.svg.line()
							.x(function(d) {
							return xRange(new Date(1000*d.time));
							})
							.y(function(d) {
							return yRange(d.energy);
							})
							.interpolate('linear');
							
						data = keefe.filter(function (el) 
    					{
    						return el.time <= maxDate&& el.time>=minDate;
						});

							svg.append('svg:path')
							.attr('d', lineFunc(data))
							.attr('stroke', dormcolors[10])
							.style("stroke-opacity", 0.3)
							.attr('stroke-width', 2)
							.attr("class", "pop keefe")
							.attr('transform', 'translate(130,260)')
							.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("Keefe")
               					.style("left", (d3.event.pageX+4) + "px")
               					.style("top", (d3.event.pageY+4) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
							.attr('fill', 'none')
					.on("click", function(d) {
						clearPopUp();
						newsvg("Keefe");
					});
					}
        		}
        		if(currentdorm != "Beard")
        		{
        			d3.selectAll(".beard").remove();
        			if(showbeard)
        			{
        				var lineFunc = d3.svg.line()
							.x(function(d) {
							return xRange(new Date(1000*d.time));
							})
							.y(function(d) {
							return yRange(d.energy);
							})
							.interpolate('linear');
						
						data = beard.filter(function (el) 
    					{
    						return el.time <= maxDate&& el.time>=minDate;
						});

							svg.append('svg:path')
							.attr('d', lineFunc(data))
							.attr('stroke', dormcolors[11])
							.style("stroke-opacity", 0.3)
							.attr('stroke-width', 2)
							.attr("class", "pop beard")
							.attr('transform', 'translate(130,260)')
							.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("Beard")
               					.style("left", (d3.event.pageX+4) + "px")
               					.style("top", (d3.event.pageY+4) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
							.attr('fill', 'none')
					.on("click", function(d) {
						clearPopUp();
						newsvg("Beard");
					});
					}
        		}
        		if(currentdorm != "Meadows")
        		{
        			d3.selectAll(".meadows").remove();
        			if(showmeadows)
        			{
        				var lineFunc = d3.svg.line()
							.x(function(d) {
							return xRange(new Date(1000*d.time));
							})
							.y(function(d) {
							return yRange(d.energy);
							})
							.interpolate('linear');
						
						data = meadows.filter(function (el) 
    					{
    						return el.time <= maxDate&& el.time>=minDate;
						});

							svg.append('svg:path')
							.attr('d', lineFunc(data))
							.attr('stroke', dormcolors[12])
							.style("stroke-opacity", 0.3)
							.attr('stroke-width', 2)
							.attr("class", "pop meadows")
							.attr('transform', 'translate(130,260)')
							.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("Meadows")
               					.style("left", (d3.event.pageX+4) + "px")
               					.style("top", (d3.event.pageY+4) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
							.attr('fill', 'none')
					.on("click", function(d) {
						clearPopUp();
						newsvg("Meadows");
					});
					}
        		}
        		if(currentdorm != "Clark")
        		{
        			d3.selectAll(".clark").remove();
        			if(showclark)
        			{
        				var lineFunc = d3.svg.line()
							.x(function(d) {
							return xRange(new Date(1000*d.time));
							})
							.y(function(d) {
							return yRange(d.energy);
							})
							.interpolate('linear');
						
						data = clark.filter(function (el) 
    					{
    						return el.time <= maxDate&& el.time>=minDate;
						});

							svg.append('svg:path')
							.attr('d', lineFunc(data))
							.attr('stroke', dormcolors[13])
							.style("stroke-opacity", 0.3)
							.attr('stroke-width', 2)
							.attr("class", "pop clark")
							.attr('transform', 'translate(130,260)')
							.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("Clark")
               					.style("left", (d3.event.pageX+4) + "px")
               					.style("top", (d3.event.pageY+4) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
							.attr('fill', 'none')
					.on("click", function(d) {
						clearPopUp();
						newsvg("Clark");
					});
					}
        		}
        		if(currentdorm != "McIntire")
        		{
        			d3.selectAll(".mcintire").remove();
        			if(showmcintire)
        			{
        				var lineFunc = d3.svg.line()
							.x(function(d) {
							return xRange(new Date(1000*d.time));
							})
							.y(function(d) {
							return yRange(d.energy);
							})
							.interpolate('linear');
							
						data = mcintire.filter(function (el) 
    					{
    						return el.time <= maxDate&& el.time>=minDate;
						});

							svg.append('svg:path')
							.attr('d', lineFunc(data))
							.attr('stroke', dormcolors[14])
							.style("stroke-opacity", 0.3)
							.attr('stroke-width', 2)
							.attr("class", "pop mcintire")
							.attr('transform', 'translate(130,260)')
							.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("McIntire")
               					.style("left", (d3.event.pageX+4) + "px")
               					.style("top", (d3.event.pageY+4) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
							.attr('fill', 'none')
					.on("click", function(d) {
						clearPopUp();
						newsvg("McIntire");
					});
					}
        		}
        		if(currentdorm != "Young")
        		{
        			d3.selectAll(".young").remove();
        			if(showyoung)
        			{
        				var lineFunc = d3.svg.line()
							.x(function(d) {
							return xRange(new Date(1000*d.time));
							})
							.y(function(d) {
							return yRange(d.energy);
							})
							.interpolate('linear');
							
						data = young.filter(function (el) 
    					{
    						return el.time <= maxDate&& el.time>=minDate;
						});

							svg.append('svg:path')
							.attr('d', lineFunc(data))
							.attr('stroke', dormcolors[15])
							.style("stroke-opacity", 0.3)
							.attr('stroke-width', 2)
							.attr("class", "pop young")
							.attr('transform', 'translate(130,260)')
							.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("Young")
               					.style("left", (d3.event.pageX+4) + "px")
               					.style("top", (d3.event.pageY+4) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
							.attr('fill', 'none')
					.on("click", function(d) {
						clearPopUp();
						newsvg("Young");
					});
					}
        		}

        		if(averageon)
        		{
        			d3.selectAll("#avg").remove();
        			svg.append("svg:line")
                        .attr("x1", MARGINS.left)
                        .attr("x2", WIDTH-MARGINS.right)
                        .attr("y1", yRange(getAverage(data)))
                        .attr("y2", yRange(getAverage(data)))
                        .attr("id", "avg")
                        .attr("class", "pop")
                        .attr('transform', 'translate(130,260)')
                        .style("stroke", "black");
                }
        	}
        	
        	function changexscale()
        	{
        		var value = document.getElementById('xaxisscale').value;
        		data = getDataToUse(currentdorm);
        		if(value == "day")
        		{
        			oneday = true;
        			oneweek = false;
        			onemonth = false;
        			oneyear = false;
        			maxDate = recenttime;
        		}
        		else if(value == "week")
        		{
        			oneday = false;
        			oneweek = true;
        			onemonth = false;
        			oneyear = false;
        			maxDate = recenttime;
        		}
        		else if(value == "month")
        		{
        			oneday = false;
        			oneweek = false;
        			onemonth = true;
        			oneyear = false;
        			maxDate = recenttime;
        		}
        		else if(value == "year")
        		{
        			oneday = false;
        			oneweek = false;
        			onemonth = false;
        			oneyear = true;
        			maxDate = recenttime;
        		}
        		else if(value == "other")
        		{
        			oneday = false;
        			oneweek = false;
        			onemonth = false;
        			oneyear = false;
        			callCalendar();
        			return;
        		}
        		str = currentdorm.replace(/\s+/g, '');
        		str = str.toLowerCase()
        		d3.selectAll("."+str).remove();
        		d3.selectAll("#xaxis").remove();
        		
        		if(oneday)
				{
					minDate = maxDate-secondsinday;
				}
				else if(oneweek)
				{
					minDate = maxDate-secondsinweek;
				}
				else if(onemonth)
				{
					minDate = maxDate-secondsinmonth;
				}
				else if(oneyear)
				{
					minDate = maxDate-secondsinyear;
				}
				
				data = data.filter(function (el) 
				{
					return el.time <= maxDate && el.time>=minDate;
				});
			   xRange = d3.time.scale().domain([new Date(minDate*1000), new Date(maxDate*1000)]).range([MARGINS.left, WIDTH - MARGINS.right]),
				
				 xAxis = d3.svg.axis()
				  .scale(xRange)
				  .tickSize(numticks)
				  .ticks(numticks);
				
				svg.append('svg:g')
				  .attr('class', 'pop')
				  .attr('id', 'xaxis')
				  .attr('transform', 'translate(130,' + (HEIGHT - MARGINS.bottom +260) + ')')
				  .call(xAxis);
				  
				  var lineFunc = d3.svg.line()
					  .x(function(d) {
						return xRange(new Date(1000*d.time));
					  })
					  .y(function(d) {
						return yRange(d.energy);
					  })
					  .interpolate('linear');
  
					  svg.append('svg:path')
					  .attr('d', lineFunc(data))
					  .attr('stroke', 'black')
					  .attr('stroke-width', 2)
					  .attr("class", function(){return getClass(currentdorm);})
					  .attr('transform', 'translate(130,260)')
					  .on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html(currentdorm)
               					.style("left", (d3.event.pageX+4) + "px")
               					.style("top", (d3.event.pageY+4) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
  						.attr('fill', 'none');
  
  
  				if(currentdorm != "Stanton")
        		{
        			d3.selectAll(".stanton").remove();
        			if(showstanton)
        			{
        				var lineFunc = d3.svg.line()
							.x(function(d) {
							return xRange(new Date(1000*d.time));
							})
							.y(function(d) {
							return yRange(d.energy);
							})
							.interpolate('linear');
						
						data = stanton.filter(function (el) 
    					{
    						return el.time <= maxDate&& el.time>=minDate;
						});

							svg.append('svg:path')
							.attr('d', lineFunc(data))
							.attr('stroke', dormcolors[9])
							.style("stroke-opacity", 0.3)
							.attr('stroke-width', 2)
							.attr("class", "pop stanton")
							.attr('transform', 'translate(130,260)')
							.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("Stanton")
               					.style("left", (d3.event.pageX+4) + "px")
               					.style("top", (d3.event.pageY+4) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
							.attr('fill', 'none')
					.on("click", function(d) {
						clearPopUp();
						newsvg("Stanton");
					});
					}
        		}
        		if(currentdorm != "Larcom")
        		{
        			d3.selectAll(".larcom").remove();
        			if(showlarcom)
        			{
        				var lineFunc = d3.svg.line()
							.x(function(d) {
							return xRange(new Date(1000*d.time));
							})
							.y(function(d) {
							return yRange(d.energy);
							})
							.interpolate('linear');
							
							data = larcom.filter(function (el) 
    					{
    						return el.time <= maxDate&& el.time>=minDate;
						});
							
							svg.append('svg:path')
							.attr('d', lineFunc(data))
							.attr('stroke', dormcolors[0])
							.attr('stroke-width', 2)
							.attr("class", "pop larcom")
							.style("stroke-opacity", 0.3)
							.attr('transform', 'translate(130,260)')
							.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("Larcom")
               					.style("left", (d3.event.pageX+4) + "px")
               					.style("top", (d3.event.pageY+4) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
							.attr('fill', 'none')
					.on("click", function(d) {
						clearPopUp();
						newsvg("Larcom");
					});
					}
        		}
        		if(currentdorm != "Kilham")
        		{
        			d3.selectAll(".kilham").remove();
        			if(showkilham)
        			{
        				var lineFunc = d3.svg.line()
							.x(function(d) {
							return xRange(new Date(1000*d.time));
							})
							.y(function(d) {
							return yRange(d.energy);
							})
							.interpolate('linear');
							
						data = kilham.filter(function (el) 
    					{
    						return el.time <= maxDate && el.time>=minDate;
						});



							svg.append('svg:path')
							.attr('d', lineFunc(data))
							.attr('stroke', dormcolors[1])
							.style("stroke-opacity", 0.3)
							.attr('stroke-width', 2)
							.attr("class", "pop kilham")
							.attr('transform', 'translate(130,260)')
							.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("Kilham")
               					.style("left", (d3.event.pageX+4) + "px")
               					.style("top", (d3.event.pageY+4) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
							.attr('fill', 'none')
					.on("click", function(d) {
						clearPopUp();
						newsvg("Kilham");
					});
					}
        		}
        		if(currentdorm != "Metcalf")
        		{
        			d3.selectAll(".metcalf").remove();
        			if(showmetcalf)
        			{
        				var lineFunc = d3.svg.line()
							.x(function(d) {
							return xRange(new Date(1000*d.time));
							})
							.y(function(d) {
							return yRange(d.energy);
							})
							.interpolate('linear');
							
						data = metcalf.filter(function (el) 
    					{
    						return el.time <= maxDate&& el.time>=minDate;
						});

							svg.append('svg:path')
							.attr('d', lineFunc(data))
							.attr('stroke', dormcolors[2])
							.style("stroke-opacity", 0.3)
							.attr('stroke-width', 2)
							.attr("class", "pop metcalf")
							.attr('transform', 'translate(130,260)')
							.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("Metcalf")
               					.style("left", (d3.event.pageX+4) + "px")
               					.style("top", (d3.event.pageY+4) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
							.attr('fill', 'none')
					.on("click", function(d) {
						clearPopUp();
						newsvg("Metcalf");
					});
					}
        		}
        		if(currentdorm != "Chapin")
        		{
        			d3.selectAll(".chapin").remove();
        			if(showchapin)
        			{
        				var lineFunc = d3.svg.line()
							.x(function(d) {
							return xRange(new Date(1000*d.time));
							})
							.y(function(d) {
							return yRange(d.energy);
							})
							.interpolate('linear');
						
						data = chapin.filter(function (el) 
    					{
    						return el.time <= maxDate&& el.time>=minDate;
						});

							svg.append('svg:path')
							.attr('d', lineFunc(data))
							.attr('stroke', dormcolors[3])
							.style("stroke-opacity", 0.3)
							.attr('stroke-width', 2)
							.attr("class", "pop chapin")
							.attr('transform', 'translate(130,260)')
							.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("Chapin")
               					.style("left", (d3.event.pageX+4) + "px")
               					.style("top", (d3.event.pageY+4) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
							.attr('fill', 'none')
					.on("click", function(d) {
						clearPopUp();
						newsvg("Chapin");
					});
					}
        		}
        		if(currentdorm != "Emerson Hall")
        		{
        			d3.selectAll(".emersonhall").remove();
        			if(showemersonhall)
        			{
        				var lineFunc = d3.svg.line()
							.x(function(d) {
							return xRange(new Date(1000*d.time));
							})
							.y(function(d) {
							return yRange(d.energy);
							})
							.interpolate('linear');
							
						data = emersonhall.filter(function (el) 
    					{
    						return el.time <= maxDate&& el.time>=minDate;
						});

							svg.append('svg:path')
							.attr('d', lineFunc(data))
							.attr('stroke', dormcolors[4])
							.style("stroke-opacity", 0.3)
							.attr('stroke-width', 2)
							.attr("class", "pop emersonhall")
							.attr('transform', 'translate(130,260)')
							.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("Emerson Hall")
               					.style("left", (d3.event.pageX+4) + "px")
               					.style("top", (d3.event.pageY+4) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
							.attr('fill', 'none')
					.on("click", function(d) {
						clearPopUp();
						newsvg("Emerson Hall");
					});
					}
        		}
        		if(currentdorm != "Everett Heights")
        		{
        			d3.selectAll(".everettheights").remove();
        			if(showeverettheights)
        			{
        				var lineFunc = d3.svg.line()
							.x(function(d) {
							return xRange(new Date(1000*d.time));
							})
							.y(function(d) {
							return yRange(d.energy);
							})
							.interpolate('linear');
							
						data = everettheights.filter(function (el) 
    					{
    						return el.time <= maxDate&& el.time>=minDate;
						});

							svg.append('svg:path')
							.attr('d', lineFunc(data))
							.attr('stroke', dormcolors[5])
							.style("stroke-opacity", 0.3)
							.attr('stroke-width', 2)
							.attr("class", "pop everettheights")
							.attr('transform', 'translate(130,260)')
							.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("Everett Heights")
               					.style("left", (d3.event.pageX+4) + "px")
               					.style("top", (d3.event.pageY+4) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
							.attr('fill', 'none')
					.on("click", function(d) {
						clearPopUp();
						newsvg("Everett Heights");
					});
					}
        		}
        		if(currentdorm != "Everett Hall")
        		{
        			d3.selectAll(".everetthall").remove();
        			if(showeveretthall)
        			{
        				var lineFunc = d3.svg.line()
							.x(function(d) {
							return xRange(new Date(1000*d.time));
							})
							.y(function(d) {
							return yRange(d.energy);
							})
							.interpolate('linear');
							
						data = everetthall.filter(function (el) 
    					{
    						return el.time <= maxDate&& el.time>=minDate;
						});

							svg.append('svg:path')
							.attr('d', lineFunc(data))
							.attr('stroke', dormcolors[6])
							.style("stroke-opacity", 0.3)
							.attr('stroke-width', 2)
							.attr("class", "pop everetthall")
							.attr('transform', 'translate(130,260)')
							.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("Everett Hall")
               					.style("left", (d3.event.pageX+4) + "px")
               					.style("top", (d3.event.pageY+4) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
							.attr('fill', 'none')
					.on("click", function(d) {
						clearPopUp();
						newsvg("Everett Hall");
					});
					}
        		}
        		if(currentdorm != "Cragin")
        		{
        			d3.selectAll(".cragin").remove();
        			if(showcragin)
        			{
        				var lineFunc = d3.svg.line()
							.x(function(d) {
							return xRange(new Date(1000*d.time));
							})
							.y(function(d) {
							return yRange(d.energy);
							})
							.interpolate('linear');
							
						data = cragin.filter(function (el) 
    					{
    						return el.time <= maxDate&& el.time>=minDate;
						});

							svg.append('svg:path')
							.attr('d', lineFunc(data))
							.attr('stroke', dormcolors[7])
							.style("stroke-opacity", 0.3)
							.attr('stroke-width', 2)
							.attr("class", "pop cragin")
							.attr('transform', 'translate(130,260)')
							.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("Cragin")
               					.style("left", (d3.event.pageX+4) + "px")
               					.style("top", (d3.event.pageY+4) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
							.attr('fill', 'none')
					.on("click", function(d) {
						clearPopUp();
						newsvg("Cragin");
					});
					}
        		}
        		if(currentdorm != "Gebbie")
        		{
        			d3.selectAll(".gebbie").remove();
        			if(showgebbie)
        			{
        				var lineFunc = d3.svg.line()
							.x(function(d) {
							return xRange(new Date(1000*d.time));
							})
							.y(function(d) {
							return yRange(d.energy);
							})
							.interpolate('linear');
							
						data = gebbie.filter(function (el) 
    					{
    						return el.time <= maxDate&& el.time>=minDate;
						});

							svg.append('svg:path')
							.attr('d', lineFunc(data))
							.attr('stroke', dormcolors[8])
							.style("stroke-opacity", 0.3)
							.attr('stroke-width', 2)
							.attr("class", "pop gebbie")
							.attr('transform', 'translate(130,260)')
							.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("Gebbie")
               					.style("left", (d3.event.pageX+4) + "px")
               					.style("top", (d3.event.pageY+4) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
							.attr('fill', 'none')
					.on("click", function(d) {
						clearPopUp();
						newsvg("Gebbie");
					});
					}
        		}
        		if(currentdorm != "Keefe")
        		{
        			d3.selectAll(".keefe").remove();
        			if(showkeefe)
        			{
        				var lineFunc = d3.svg.line()
							.x(function(d) {
							return xRange(new Date(1000*d.time));
							})
							.y(function(d) {
							return yRange(d.energy);
							})
							.interpolate('linear');
							
						data = keefe.filter(function (el) 
    					{
    						return el.time <= maxDate&& el.time>=minDate;
						});

							svg.append('svg:path')
							.attr('d', lineFunc(data))
							.attr('stroke', dormcolors[10])
							.style("stroke-opacity", 0.3)
							.attr('stroke-width', 2)
							.attr("class", "pop keefe")
							.attr('transform', 'translate(130,260)')
							.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("Keefe")
               					.style("left", (d3.event.pageX+4) + "px")
               					.style("top", (d3.event.pageY+4) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
							.attr('fill', 'none')
					.on("click", function(d) {
						clearPopUp();
						newsvg("Keefe");
					});
					}
        		}
        		if(currentdorm != "Beard")
        		{
        			d3.selectAll(".beard").remove();
        			if(showbeard)
        			{
        				var lineFunc = d3.svg.line()
							.x(function(d) {
							return xRange(new Date(1000*d.time));
							})
							.y(function(d) {
							return yRange(d.energy);
							})
							.interpolate('linear');
						
						data = beard.filter(function (el) 
    					{
    						return el.time <= maxDate&& el.time>=minDate;
						});

							svg.append('svg:path')
							.attr('d', lineFunc(data))
							.attr('stroke', dormcolors[11])
							.style("stroke-opacity", 0.3)
							.attr('stroke-width', 2)
							.attr("class", "pop beard")
							.attr('transform', 'translate(130,260)')
							.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("Beard")
               					.style("left", (d3.event.pageX+4) + "px")
               					.style("top", (d3.event.pageY+4) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
							.attr('fill', 'none')
					.on("click", function(d) {
						clearPopUp();
						newsvg("Beard");
					});
					}
        		}
        		if(currentdorm != "Meadows")
        		{
        			d3.selectAll(".meadows").remove();
        			if(showmeadows)
        			{
        				var lineFunc = d3.svg.line()
							.x(function(d) {
							return xRange(new Date(1000*d.time));
							})
							.y(function(d) {
							return yRange(d.energy);
							})
							.interpolate('linear');
						
						data = meadows.filter(function (el) 
    					{
    						return el.time <= maxDate&& el.time>=minDate;
						});

							svg.append('svg:path')
							.attr('d', lineFunc(data))
							.attr('stroke', dormcolors[12])
							.style("stroke-opacity", 0.3)
							.attr('stroke-width', 2)
							.attr("class", "pop meadows")
							.attr('transform', 'translate(130,260)')
							.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("Meadows")
               					.style("left", (d3.event.pageX+4) + "px")
               					.style("top", (d3.event.pageY+4) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
							.attr('fill', 'none')
					.on("click", function(d) {
						clearPopUp();
						newsvg("Meadows");
					});
					}
        		}
        		if(currentdorm != "Clark")
        		{
        			d3.selectAll(".clark").remove();
        			if(showclark)
        			{
        				var lineFunc = d3.svg.line()
							.x(function(d) {
							return xRange(new Date(1000*d.time));
							})
							.y(function(d) {
							return yRange(d.energy);
							})
							.interpolate('linear');
						
						data = clark.filter(function (el) 
    					{
    						return el.time <= maxDate&& el.time>=minDate;
						});

							svg.append('svg:path')
							.attr('d', lineFunc(data))
							.attr('stroke', dormcolors[13])
							.style("stroke-opacity", 0.3)
							.attr('stroke-width', 2)
							.attr("class", "pop clark")
							.attr('transform', 'translate(130,260)')
							.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("Clark")
               					.style("left", (d3.event.pageX+4) + "px")
               					.style("top", (d3.event.pageY+4) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
							.attr('fill', 'none')
					.on("click", function(d) {
						clearPopUp();
						newsvg("Clark");
					});
					}
        		}
        		if(currentdorm != "McIntire")
        		{
        			d3.selectAll(".mcintire").remove();
        			if(showmcintire)
        			{
        				var lineFunc = d3.svg.line()
							.x(function(d) {
							return xRange(new Date(1000*d.time));
							})
							.y(function(d) {
							return yRange(d.energy);
							})
							.interpolate('linear');
							
						data = mcintire.filter(function (el) 
    					{
    						return el.time <= maxDate&& el.time>=minDate;
						});

							svg.append('svg:path')
							.attr('d', lineFunc(data))
							.attr('stroke', dormcolors[14])
							.style("stroke-opacity", 0.3)
							.attr('stroke-width', 2)
							.attr("class", "pop mcintire")
							.attr('transform', 'translate(130,260)')
							.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("McIntire")
               					.style("left", (d3.event.pageX+4) + "px")
               					.style("top", (d3.event.pageY+4) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
							.attr('fill', 'none')
					.on("click", function(d) {
						clearPopUp();
						newsvg("McIntire");
					});
					}
        		}
        		if(currentdorm != "Young")
        		{
        			d3.selectAll(".young").remove();
        			if(showyoung)
        			{
        				var lineFunc = d3.svg.line()
							.x(function(d) {
							return xRange(new Date(1000*d.time));
							})
							.y(function(d) {
							return yRange(d.energy);
							})
							.interpolate('linear');
							
						data = young.filter(function (el) 
    					{
    						return el.time <= maxDate&& el.time>=minDate;
						});

							svg.append('svg:path')
							.attr('d', lineFunc(data))
							.attr('stroke', dormcolors[15])
							.style("stroke-opacity", 0.3)
							.attr('stroke-width', 2)
							.attr("class", "pop young")
							.attr('transform', 'translate(130,260)')
							.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("Young")
               					.style("left", (d3.event.pageX+4) + "px")
               					.style("top", (d3.event.pageY+4) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
							.attr('fill', 'none')
					.on("click", function(d) {
						clearPopUp();
						newsvg("Young");
					});
					}
        		}

        		if(averageon)
        		{
        			d3.selectAll("#avg").remove();
        			svg.append("svg:line")
                        .attr("x1", MARGINS.left)
                        .attr("x2", WIDTH-MARGINS.right)
                        .attr("y1", yRange(getAverage(data)))
                        .attr("y2", yRange(getAverage(data)))
                        .attr("id", "avg")
                        .attr("class", "pop")
                        .attr('transform', 'translate(130,260)')
                        .style("stroke", "black");
                }
        		
        	}
        	
        	function showLarcom()
        	{
        		if(currentdorm != "Larcom")
        		{
					showlarcom = !showlarcom;
        			if(showlarcom)
        			{
        				var lineFunc = d3.svg.line()
							.x(function(d) {
							return xRange(new Date(1000*d.time));
							})
							.y(function(d) {
							return yRange(d.energy);
							})
							.interpolate('linear');
							
							data = larcom.filter(function (el) 
    					{
    						return el.time <= maxDate&& el.time>=minDate;
						});
							
							svg.append('svg:path')
							.attr('d', lineFunc(data))
							.attr('stroke', dormcolors[0])
							.attr('stroke-width', 2)
							.attr("class", "pop larcom")
							.style("stroke-opacity", 0.3)
							.attr('transform', 'translate(130,260)')
							.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("Larcom")
               					.style("left", (d3.event.pageX+4) + "px")
               					.style("top", (d3.event.pageY+4) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
							.attr('fill', 'none')
					.on("click", function(d) {
						clearPopUp();
						newsvg("Larcom");
					});
					}
					else
					{
						d3.selectAll(".larcom").remove();
					}
        		}
        		else
        		{
        			document.getElementById("graphlarcom").checked = true;
        		}				
        	}	
        	
        	function showKilham()
        	{
        		if(currentdorm != "Kilham")
        		{
					showkilham = !showkilham;
        			if(showkilham)
        			{
        				var lineFunc = d3.svg.line()
							.x(function(d) {
							return xRange(new Date(1000*d.time));
							})
							.y(function(d) {
							return yRange(d.energy);
							})
							.interpolate('linear');
							
						data = kilham.filter(function (el) 
    					{
    						return el.time <= maxDate && el.time>=minDate;
						});



							svg.append('svg:path')
							.attr('d', lineFunc(data))
							.attr('stroke', dormcolors[1])
							.style("stroke-opacity", 0.3)
							.attr('stroke-width', 2)
							.attr("class", "pop kilham")
							.attr('transform', 'translate(130,260)')
							.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("Kilham")
               					.style("left", (d3.event.pageX+4) + "px")
               					.style("top", (d3.event.pageY+4) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
							.attr('fill', 'none')
					.on("click", function(d) {
						clearPopUp();
						newsvg("Kilham");
					});
					}
					else
					{
						d3.selectAll(".kilham").remove();
					}
        		}
        		else
        		{
        			document.getElementById("graphkilham").checked = true;
        		}				
        	}
        	
        	function showMetcalf()
        	{
        		if(currentdorm != "Metcalf")
        		{
					showmetcalf = !showmetcalf;
        			if(showmetcalf)
        			{
        				var lineFunc = d3.svg.line()
							.x(function(d) {
							return xRange(new Date(1000*d.time));
							})
							.y(function(d) {
							return yRange(d.energy);
							})
							.interpolate('linear');
							
						data = metcalf.filter(function (el) 
    					{
    						return el.time <= maxDate&& el.time>=minDate;
						});

							svg.append('svg:path')
							.attr('d', lineFunc(data))
							.attr('stroke', dormcolors[2])
							.style("stroke-opacity", 0.3)
							.attr('stroke-width', 2)
							.attr("class", "pop metcalf")
							.attr('transform', 'translate(130,260)')
							.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("Metcalf")
               					.style("left", (d3.event.pageX+4) + "px")
               					.style("top", (d3.event.pageY+4) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
							.attr('fill', 'none')
					.on("click", function(d) {
						clearPopUp();
						newsvg("Metcalf");
					});
					}
					else
					{
						d3.selectAll(".metcalf").remove();
					}
        		}
        		else
        		{
        			document.getElementById("graphmetcalf").checked = true;
        		}				
        	}
        	
        	function showChapin()
        	{
        		if(currentdorm != "Chapin")
        		{
					showchapin = !showchapin;
        			if(showchapin)
        			{
        				var lineFunc = d3.svg.line()
							.x(function(d) {
							return xRange(new Date(1000*d.time));
							})
							.y(function(d) {
							return yRange(d.energy);
							})
							.interpolate('linear');
						
						data = chapin.filter(function (el) 
    					{
    						return el.time <= maxDate&& el.time>=minDate;
						});

							svg.append('svg:path')
							.attr('d', lineFunc(data))
							.attr('stroke', dormcolors[3])
							.style("stroke-opacity", 0.3)
							.attr('stroke-width', 2)
							.attr("class", "pop chapin")
							.attr('transform', 'translate(130,260)')
							.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("Chapin")
               					.style("left", (d3.event.pageX+4) + "px")
               					.style("top", (d3.event.pageY+4) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
							.attr('fill', 'none')
					.on("click", function(d) {
						clearPopUp();
						newsvg("Chapin");
					});
					}
					else
					{
						d3.selectAll(".chapin").remove();
					}
        		}
        		else
        		{
        			document.getElementById("graphchapin").checked = true;
        		}				
        	}	
        	
        	function showEmersonHall()
        	{
        		if(currentdorm != "Emerson Hall")
        		{
					showemersonhall = !showemersonhall;
        			if(showemersonhall)
        			{
        				var lineFunc = d3.svg.line()
							.x(function(d) {
							return xRange(new Date(1000*d.time));
							})
							.y(function(d) {
							return yRange(d.energy);
							})
							.interpolate('linear');
							
						data = emersonhall.filter(function (el) 
    					{
    						return el.time <= maxDate&& el.time>=minDate;
						});

							svg.append('svg:path')
							.attr('d', lineFunc(data))
							.attr('stroke', dormcolors[4])
							.style("stroke-opacity", 0.3)
							.attr('stroke-width', 2)
							.attr("class", "pop emersonhall")
							.attr('transform', 'translate(130,260)')
							.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("Emerson Hall")
               					.style("left", (d3.event.pageX+4) + "px")
               					.style("top", (d3.event.pageY+4) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
							.attr('fill', 'none')
					.on("click", function(d) {
						clearPopUp();
						newsvg("Emerson Hall");
					});
					}
					else
					{
						d3.selectAll(".emersonhall").remove();
					}
        		}
        		else
        		{
        			document.getElementById("graphemersonhall").checked = true;
        		}				
        	}
        	
        	function showEverettHeights()
        	{
        		if(currentdorm != "Everett Heights")
        		{
					showeverettheights = !showeverettheights;
        			if(showeverettheights)
        			{
        				var lineFunc = d3.svg.line()
							.x(function(d) {
							return xRange(new Date(1000*d.time));
							})
							.y(function(d) {
							return yRange(d.energy);
							})
							.interpolate('linear');
							
						data = everettheights.filter(function (el) 
    					{
    						return el.time <= maxDate&& el.time>=minDate;
						});

							svg.append('svg:path')
							.attr('d', lineFunc(data))
							.attr('stroke', dormcolors[5])
							.style("stroke-opacity", 0.3)
							.attr('stroke-width', 2)
							.attr("class", "pop everettheights")
							.attr('transform', 'translate(130,260)')
							.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("Everett Heights")
               					.style("left", (d3.event.pageX+4) + "px")
               					.style("top", (d3.event.pageY+4) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
							.attr('fill', 'none')
					.on("click", function(d) {
						clearPopUp();
						newsvg("Everett Heights");
					});
					}
					else
					{
						d3.selectAll(".everettheights").remove();
					}
        		}
        		else
        		{
        			document.getElementById("grapheverettheights").checked = true;
        		}				
        	}
        	
        	function showEverettHall()
        	{
        		if(currentdorm != "Everett Hall")
        		{
					showeveretthall = !showeveretthall;
        			if(showeveretthall)
        			{
        				var lineFunc = d3.svg.line()
							.x(function(d) {
							return xRange(new Date(1000*d.time));
							})
							.y(function(d) {
							return yRange(d.energy);
							})
							.interpolate('linear');
							
						data = everetthall.filter(function (el) 
    					{
    						return el.time <= maxDate&& el.time>=minDate;
						});

							svg.append('svg:path')
							.attr('d', lineFunc(data))
							.attr('stroke', dormcolors[6])
							.style("stroke-opacity", 0.3)
							.attr('stroke-width', 2)
							.attr("class", "pop everetthall")
							.attr('transform', 'translate(130,260)')
							.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("Everett Hall")
               					.style("left", (d3.event.pageX+4) + "px")
               					.style("top", (d3.event.pageY+4) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
							.attr('fill', 'none')
					.on("click", function(d) {
						clearPopUp();
						newsvg("Everett Hall");
					});
					}
					else
					{
						d3.selectAll(".everetthall").remove();
					}
        		}
        		else
        		{
        			document.getElementById("grapheveretthall").checked = true;
        		}				
        	}
        	
        	function showCragin()
        	{
        		if(currentdorm != "Cragin")
        		{
					showcragin = !showcragin;
        			if(showcragin)
        			{
        				var lineFunc = d3.svg.line()
							.x(function(d) {
							return xRange(new Date(1000*d.time));
							})
							.y(function(d) {
							return yRange(d.energy);
							})
							.interpolate('linear');
							
						data = cragin.filter(function (el) 
    					{
    						return el.time <= maxDate&& el.time>=minDate;
						});

							svg.append('svg:path')
							.attr('d', lineFunc(data))
							.attr('stroke', dormcolors[7])
							.style("stroke-opacity", 0.3)
							.attr('stroke-width', 2)
							.attr("class", "pop cragin")
							.attr('transform', 'translate(130,260)')
							.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("Cragin")
               					.style("left", (d3.event.pageX+4) + "px")
               					.style("top", (d3.event.pageY+4) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
							.attr('fill', 'none')
					.on("click", function(d) {
						clearPopUp();
						newsvg("Cragin");
					});
					}
					else
					{
						d3.selectAll(".cragin").remove();
					}
        		}
        		else
        		{
        			document.getElementById("graphcragin").checked = true;
        		}				
        	}
        	
        	function showGebbie()
        	{
        		if(currentdorm != "Gebbie")
        		{
					showgebbie = !showgebbie;
        			if(showgebbie)
        			{
        				var lineFunc = d3.svg.line()
							.x(function(d) {
							return xRange(new Date(1000*d.time));
							})
							.y(function(d) {
							return yRange(d.energy);
							})
							.interpolate('linear');
							
						data = gebbie.filter(function (el) 
    					{
    						return el.time <= maxDate&& el.time>=minDate;
						});

							svg.append('svg:path')
							.attr('d', lineFunc(data))
							.attr('stroke', dormcolors[8])
							.style("stroke-opacity", 0.3)
							.attr('stroke-width', 2)
							.attr("class", "pop gebbie")
							.attr('transform', 'translate(130,260)')
							.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("Gebbie")
               					.style("left", (d3.event.pageX+4) + "px")
               					.style("top", (d3.event.pageY+4) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
							.attr('fill', 'none')
					.on("click", function(d) {
						clearPopUp();
						newsvg("Gebbie");
					});
					}
					else
					{
						d3.selectAll(".gebbie").remove();
					}
        		}
        		else
        		{
        			document.getElementById("graphgebbie").checked = true;
        		}				
        	}
        	
        	function showStanton()
        	{
        		if(currentdorm != "Stanton")
        		{
					showstanton = !showstanton;
        			if(showstanton)
        			{
        				var lineFunc = d3.svg.line()
							.x(function(d) {
							return xRange(new Date(1000*d.time));
							})
							.y(function(d) {
							return yRange(d.energy);
							})
							.interpolate('linear');
						
						data = stanton.filter(function (el) 
    					{
    						return el.time <= maxDate&& el.time>=minDate;
						});

							svg.append('svg:path')
							.attr('d', lineFunc(data))
							.attr('stroke', dormcolors[9])
							.style("stroke-opacity", 0.3)
							.attr('stroke-width', 2)
							.attr("class", "pop stanton")
							.attr('transform', 'translate(130,260)')
							.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("Stanton")
               					.style("left", (d3.event.pageX+4) + "px")
               					.style("top", (d3.event.pageY+4) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
							.attr('fill', 'none')
					.on("click", function(d) {
						clearPopUp();
						newsvg("Stanton");
					});
					}
					else
					{
						d3.selectAll(".stanton").remove();
					}
        		}
        		else
        		{
        			document.getElementById("graphstanton").checked = true;
        		}				
        	}
        	
        	function showKeefe()
        	{
        		if(currentdorm != "Keefe")
        		{
					showkeefe = !showkeefe;
        			if(showkeefe)
        			{
        				var lineFunc = d3.svg.line()
							.x(function(d) {
							return xRange(new Date(1000*d.time));
							})
							.y(function(d) {
							return yRange(d.energy);
							})
							.interpolate('linear');
							
						data = keefe.filter(function (el) 
    					{
    						return el.time <= maxDate&& el.time>=minDate;
						});

							svg.append('svg:path')
							.attr('d', lineFunc(data))
							.attr('stroke', dormcolors[10])
							.style("stroke-opacity", 0.2)
							.attr('stroke-width', 2)
							.attr("class", "pop keefe")
							.attr('transform', 'translate(130,260)')
							.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("Keefe")
               					.style("left", (d3.event.pageX+4) + "px")
               					.style("top", (d3.event.pageY+4) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
							.attr('fill', 'none')
						.on("click", function(d) {
						clearPopUp();
						newsvg("Keefe");
					});
					}
					else
					{
						d3.selectAll(".keefe").remove();
					}
        		}
        		else
        		{
        			document.getElementById("graphkeefe").checked = true;
        		}				
        	}
        	
        	function showBeard()
        	{
        		if(currentdorm != "Beard")
        		{
					showbeard = !showbeard;
        			if(showbeard)
        			{
        				var lineFunc = d3.svg.line()
							.x(function(d) {
							return xRange(new Date(1000*d.time));
							})
							.y(function(d) {
							return yRange(d.energy);
							})
							.interpolate('linear');
						
						data = beard.filter(function (el) 
    					{
    						return el.time <= maxDate&& el.time>=minDate;
						});

							svg.append('svg:path')
							.attr('d', lineFunc(data))
							.attr('stroke', dormcolors[11])
							.style("stroke-opacity", 0.3)
							.attr('stroke-width', 2)
							.attr("class", "pop beard")
							.attr('transform', 'translate(130,260)')
							.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("Beard")
               					.style("left", (d3.event.pageX+4) + "px")
               					.style("top", (d3.event.pageY+4) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
							.attr('fill', 'none')
					.on("click", function(d) {
						clearPopUp();
						newsvg("Beard");
					});
					}
					else
					{
						d3.selectAll(".beard").remove();
					}
        		}
        		else
        		{
        			document.getElementById("graphbeard").checked = true;
        		}				
        	}
        	
        	function showMeadows()
        	{
        		if(currentdorm != "Meadows")
        		{
					showmeadows = !showmeadows;
        			if(showmeadows)
        			{
        				var lineFunc = d3.svg.line()
							.x(function(d) {
							return xRange(new Date(1000*d.time));
							})
							.y(function(d) {
							return yRange(d.energy);
							})
							.interpolate('linear');
						
						data = meadows.filter(function (el) 
    					{
    						return el.time <= maxDate&& el.time>=minDate;
						});

							svg.append('svg:path')
							.attr('d', lineFunc(data))
							.attr('stroke', dormcolors[12])
							.style("stroke-opacity", 0.3)
							.attr('stroke-width', 2)
							.attr("class", "pop meadows")
							.attr('transform', 'translate(130,260)')
							.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("Meadows")
               					.style("left", (d3.event.pageX+4) + "px")
               					.style("top", (d3.event.pageY+4) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
							.attr('fill', 'none')
					.on("click", function(d) {
						clearPopUp();
						newsvg("Meadows");
					});
					}
					else
					{
						d3.selectAll(".meadows").remove();
					}
        		}
        		else
        		{
        			document.getElementById("graphmeadows").checked = true;
        		}				
        	}
        	
        	function showClark()
        	{
        		if(currentdorm != "Clark")
        		{
					showclark = !showclark;
        			if(showclark)
        			{
        				var lineFunc = d3.svg.line()
							.x(function(d) {
							return xRange(new Date(1000*d.time));
							})
							.y(function(d) {
							return yRange(d.energy);
							})
							.interpolate('linear');
						
						data = clark.filter(function (el) 
    					{
    						return el.time <= maxDate&& el.time>=minDate;
						});

							svg.append('svg:path')
							.attr('d', lineFunc(data))
							.attr('stroke', dormcolors[13])
							.style("stroke-opacity", 0.3)
							.attr('stroke-width', 2)
							.attr("class", "pop clark")
							.attr('transform', 'translate(130,260)')
							.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("Clark")
               					.style("left", (d3.event.pageX+4) + "px")
               					.style("top", (d3.event.pageY+4) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
							.attr('fill', 'none')
					.on("click", function(d) {
						clearPopUp();
						newsvg("Clark");
					});
					}
					else
					{
						d3.selectAll(".clark").remove();
					}
        		}
        		else
        		{
        			document.getElementById("graphclark").checked = true;
        		}				
        	}
        	
        	function showMcintire()
        	{
        		if(currentdorm != "McIntire")
        		{
					showmcintire = !showmcintire;
        			if(showmcintire)
        			{
        				var lineFunc = d3.svg.line()
							.x(function(d) {
							return xRange(new Date(1000*d.time));
							})
							.y(function(d) {
							return yRange(d.energy);
							})
							.interpolate('linear');
							
						data = mcintire.filter(function (el) 
    					{
    						return el.time <= maxDate&& el.time>=minDate;
						});

							svg.append('svg:path')
							.attr('d', lineFunc(data))
							.attr('stroke', dormcolors[14])
							.style("stroke-opacity", 0.3)
							.attr('stroke-width', 2)
							.attr("class", "pop mcintire")
							.attr('transform', 'translate(130,260)')
							.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("McIntire")
               					.style("left", (d3.event.pageX+4) + "px")
               					.style("top", (d3.event.pageY+4) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
							.attr('fill', 'none')
					.on("click", function(d) {
						clearPopUp();
						newsvg("McIntire");
					});
					}
					else
					{
						d3.selectAll(".mcintire").remove();
					}
        		}
        		else
        		{
        			document.getElementById("graphmcintire").checked = true;
        		}				
        	}
        	
        	function showYoung()
        	{
        		if(currentdorm != "Young")
        		{
					showyoung = !showyoung;
        			if(showyoung)
        			{
        				var lineFunc = d3.svg.line()
							.x(function(d) {
							return xRange(new Date(1000*d.time));
							})
							.y(function(d) {
							return yRange(d.energy);
							})
							.interpolate('linear');
							
						data = young.filter(function (el) 
    					{
    						return el.time <= maxDate&& el.time>=minDate;
						});

							svg.append('svg:path')
							.attr('d', lineFunc(data))
							.attr('stroke', dormcolors[15])
							.style("stroke-opacity", 0.3)
							.attr('stroke-width', 2)
							.attr("class", "pop young")
							.attr('transform', 'translate(130,260)')
							.on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html("Young")
               					.style("left", (d3.event.pageX+4) + "px")
               					.style("top", (d3.event.pageY+4) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
							.attr('fill', 'none')
					.on("click", function(d) {
						clearPopUp();
						newsvg("Young");
					});
					}
					else
					{
						d3.selectAll(".young").remove();
					}
        		}
        		else
        		{
        			document.getElementById("graphyoung").checked = true;
        		}				
        	}
        	
        	function clearPopUp()
        	{
        		d3.selectAll(".pop").remove();
        		
        		baseon = false;
        		averageon = false;
        		goalon = false;
        		compareschools = false;
        		comparebuildings = false;
        		showlarcom = false;
        		showkilham = false;
        		showmetcalf = false;
        		showchapin = false;
        		showemersonhall = false;
        		showeverettheights = false;
        		showeveretthall = false;
        		showcragin = false;
        		showstanton= false;
        		showgebbie = false;
        		showkeefe = false;
        		showbeard = false;
        		showmeadows = false;
        		showclark = false;
        		showmcintire = false;
        		showyoung = false;
        		
        		oneday = true;
				oneweek = false;
				onemonth = false;
				oneyear = false;
				
				converttomoney = false;
				converttoco2 = false;
        	}
        	
        	
        	function recentdata()
        	{
        		recent.push({name:"metcalf", usage:metcalf[0].energy});
        		recent.push({name:"larcom", usage:larcom[0].energy});
        		recent.push({name:"kilham", usage:kilham[0].energy});
        		recent.push({name:"chapin", usage:chapin[0].energy});
        		recent.push({name:"emersonhall", usage:emersonhall[0].energy});
        		recent.push({name:"everettheights", usage:everettheights[0].energy});
        		recent.push({name:"everetthall", usage:everetthall[0].energy});
        		recent.push({name:"cragin", usage:cragin[0].energy});
        		recent.push({name:"stanton", usage:stanton[0].energy});
        		recent.push({name:"gebbie", usage:gebbie[0].energy});
        		recent.push({name:"keefe", usage:keefe[0].energy});
        		recent.push({name:"beard", usage:beard[0].energy});
        		recent.push({name:"meadows", usage:meadows[0].energy});
        		recent.push({name:"clark", usage:clark[0].energy});
        		recent.push({name:"mcintire", usage:mcintire[0].energy});
        		recent.push({name:"young", usage:young[0].energy});
        		
        		recent.sort(function(a,b)
        				{
        					return parseFloat(b.usage) - parseFloat(a.usage);
        				});
        
        	}
        	
        	function choosecolor()
        	{
        		var value = document.getElementById('settings').value;
        		if(value == "blue")
        		{
        			redgrad = false;
        			bluegrad = true;
        			textgrad = false;
        			d3.selectAll(".gradient").remove();
      			
					svg.append("svg:image")
						.attr("xlink:href", "BlueYellow.png")
						.attr("width", "180")
						.attr("height", "100%")
						.attr("x",1000)
						.attr("y",400)
						.attr("class", "gradient");
        		}
        		else if(value == "red")
        		{
        			redgrad=true;
        			bluegrad=false;
        			textgrad = false;
      				d3.selectAll(".gradient").remove();
					svg.append("svg:image")
						.attr("xlink:href", "redGreenGradient.png")
						.attr("width", "180")
						.attr("height", "100%")
						.attr("x",1000)
						.attr("y",400)
						.attr("class", "gradient");
        		}
        		else if(value == "texture")
        		{
        			redgrad=false;
        			bluegrad=false;
        			textgrad = true;
      				d3.selectAll(".gradient").remove();
					svg.append("svg:image")
						.attr("xlink:href", "texturegrad.png")
						.attr("width", "180")
						.attr("height", "100%")
						.attr("x",1000)
						.attr("y",400)
						.attr("class", "gradient");
        		}
        		else if(value == "labelon")
        		{
        			drawLabels();
        		}
        		else if(value =="labeloff")
        		{
        			d3.selectAll(".label").remove();
        		}
        		
        		for(var i = 0; i < 16; i++)
        		{
        			if(redgrad)
        				document.getElementById(recent[i].name+"building").style.fill = redgreen[i];
        			else if(bluegrad)
        				document.getElementById(recent[i].name+"building").style.fill = blueyell[i];
        			else if(textgrad)
        				document.getElementById(recent[i].name+"building").style.fill = texture[i];
        		}
        	}
        	
        	function toggleLabels()
        	{
        		alert("toggle");
        		showlabels = !showlabels;
				if(showlabels)
					drawLabels();
				else
					d3.selectAll(".label").remove();
        	}
        	
        	function getAverage(data)
        	{
        		return d3.mean(data,function(d) { return +d.energy});
        	}
        	
        	function setup()
        	{
        		d3.selectAll(".loading").remove();
        		recentdata();
        		
        		for(var i = 0; i < 16; i++)
        		{
        			if(redgrad)
        				document.getElementById(recent[i].name+"building").style.fill = redgreen[i];
        			else if(bluegrad)
        				document.getElementById(recent[i].name+"building").style.fill = blueyell[i];
        		}
        	}
        	
        	function showAverage()
        	{
        		data = getDataToUse(currentdorm);
        		data = data.filter(function (el) 
				{
					return el.time <= maxDate && el.time>=minDate;
				});
        		
        		averageon = !averageon;
        		if(averageon)
        		{
        			svg.append("svg:line")
                        .attr("x1", MARGINS.left)
                        .attr("x2", WIDTH-MARGINS.right)
                        .attr("y1", yRange(getAverage(data)))
                        .attr("y2", yRange(getAverage(data)))
                        .attr("id", "avg")
                        .attr("class", "pop")
                        .attr('transform', 'translate(130,260)')
                        .style("stroke", "black");
                        
                    svg.append("text")
					.attr("font-size", "12px")
					.attr("x", WIDTH-MARGINS.right)
					.attr("y", yRange(getAverage(data))+4)
					.attr('transform', 'translate(130,260)')
					.attr("fill", "black")
					.attr("id", "avgtext")
					.attr("class", "pop")
					.text("Avg");
                }
                else
                {
                	d3.selectAll("#avg").remove();
                	d3.selectAll("#avgtext").remove();
                }
        	}
        	
        	function showGoal()
        	{
        		goalon = !goalon;
        		if(goalon)
        		{
        			svg.append("svg:line")
                        .attr("x1", MARGINS.left)
                        .attr("x2", WIDTH-MARGINS.right)
                        .attr("y1", yRange(goal))
                        .attr("y2", yRange(goal))
                        .attr("id", "goal")
                        .attr("class", "pop")
                        .attr('transform', 'translate(130,260)')
                        .style("stroke", "black");
                        
                    svg.append("text")
					.attr("font-size", "12px")
					.attr("x", WIDTH-MARGINS.right)
					.attr("y", yRange(goal)+4)
					.attr('transform', 'translate(130,260)')
					.attr("fill", "black")
					.attr("id", "goaltext")
					.attr("class", "pop")
					.text("Goal");
                }
                else
                {
                	d3.selectAll("#goal").remove();
                	d3.selectAll("#goaltext").remove();
                }
        	}
        	
        	function showBase()
        	{
        		baseon = !baseon;
        		if(baseon)
        		{
        			svg.append("svg:line")
                        .attr("x1", MARGINS.left)
                        .attr("x2", WIDTH-MARGINS.right)
                        .attr("y1", yRange(base))
                        .attr("y2", yRange(base))
                        .attr("id", "base")
                        .attr("class", "pop")
                        .attr('transform', 'translate(130,260)')
                        .style("stroke", "black");
                        
                    svg.append("text")
					.attr("font-size", "12px")
					.attr("x", WIDTH-MARGINS.right)
					.attr("y", yRange(base)+4)
					.attr('transform', 'translate(130,260)')
					.attr("fill", "black")
					.attr("id", "basetext")
					.attr("class", "pop")
					.text("Base");
                }
                else
                {
                	d3.selectAll("#base").remove();
                	d3.selectAll("#basetext").remove();
                }
        	}
        		
        		
        	function getMaxY()
        	{
        		arrayofmax = [];
        		arrayofmax.push(d3.max(larcom, function(d) { return +d.energy;} ));
        		arrayofmax.push(d3.max(kilham, function(d) { return +d.energy;} ));
        		arrayofmax.push(d3.max(metcalf, function(d) { return +d.energy;} ));
        		arrayofmax.push(d3.max(chapin, function(d) { return +d.energy;} ));
        		arrayofmax.push(d3.max(emersonhall, function(d) { return +d.energy;} ));
        		arrayofmax.push(d3.max(everettheights, function(d) { return +d.energy;} ));
        		arrayofmax.push(d3.max(everetthall, function(d) { return +d.energy;} ));
        		arrayofmax.push(d3.max(cragin, function(d) { return +d.energy;} ));
        		arrayofmax.push(d3.max(stanton, function(d) { return +d.energy;} ));
        		arrayofmax.push(d3.max(gebbie, function(d) { return +d.energy;} ));
        		arrayofmax.push(d3.max(keefe, function(d) { return +d.energy;} ));
        		arrayofmax.push(d3.max(beard, function(d) { return +d.energy;} ));
        		arrayofmax.push(d3.max(meadows, function(d) { return +d.energy;} ));
        		arrayofmax.push(d3.max(clark, function(d) { return +d.energy;} ));
        		arrayofmax.push(d3.max(mcintire, function(d) { return +d.energy;} ));
        		arrayofmax.push(d3.max(young, function(d) { return +d.energy;} ));
        		return d3.max(arrayofmax);
        	}	
        	
        	function reset()
        	{
        		baseon = false;
        		averageon = false;
        		goalon = false;
        		compareschools = false;
        		comparebuildings = false;
        		showlarcom = false;
        		showkilham = false;
        		showmetcalf = false;
        		showchapin = false;
        		showemersonhall = false;
        		showeverettheights = false;
        		showeveretthall = false;
        		showcragin = false;
        		showstanton= false;
        		showgebbie = false;
        		showkeefe = false;
        		showbeard = false;
        		showmeadows = false;
        		showclark = false;
        		showmcintire = false;
        		showyoung = false;
        		oneday = true;
				oneweek = false;
				onemonth = false;
				oneyear = false;
				
				converttoco2 = false;
				converttomoney = false;
				maxDate = recenttime;
        		
        		d3.selectAll("#base").remove();
        		d3.selectAll("#goal").remove();
        		d3.selectAll("#avg").remove();
        		d3.selectAll("#goaltext").remove();
        		d3.selectAll("#basetext").remove();
        		d3.selectAll("#avgtext").remove();
        		
        		document.getElementById("averageline").checked = false;
        		document.getElementById("baseline").checked = false;
        		document.getElementById("goalline").checked = false;
        		document.getElementById("money").checked = false;
        		document.getElementById("co").checked = false;
        		
        		d3.selectAll("#yaxislabel").remove();
        			svg2.append("text")
					.attr("transform", "translate(130,490)rotate(270)")
					.attr("font-size", "18px")
					.attr("id", "yaxislabel")
					.attr("class", "pop")
					.text("kwh");
        		
        		if(currentdorm != "Stanton")
        		{
        			d3.selectAll(".stanton").remove();
        			document.getElementById("graphstanton").checked = false;
        		}
        		if(currentdorm != "Larcom")
        		{
        			d3.selectAll(".larcom").remove();
        			document.getElementById("graphlarcom").checked = false;
        		}
        		if(currentdorm != "Kilham")
        		{
        			d3.selectAll(".kilham").remove();
        			document.getElementById("graphkilham").checked = false;
        		}
        		if(currentdorm != "Metcalf")
        		{
        			d3.selectAll(".metcalf").remove();
        			document.getElementById("graphmetcalf").checked = false;
        		}
        		if(currentdorm != "Chapin")
        		{
        			d3.selectAll(".chapin").remove();
        			document.getElementById("graphchapin").checked = false;
        		}
        		if(currentdorm != "Emerson Hall")
        		{
        			d3.selectAll(".emersonhall").remove();
        			document.getElementById("graphemersonhall").checked = false;
        		}
        		if(currentdorm != "Everett Heights")
        		{
        			d3.selectAll(".everettheights").remove();
        			document.getElementById("grapheverettheights").checked = false;
        		}
        		if(currentdorm != "Everett Hall")
        		{
        			d3.selectAll(".everetthall").remove();
        			document.getElementById("grapheveretthall").checked = false;
        		}
        		if(currentdorm != "Cragin")
        		{
        			d3.selectAll(".cragin").remove();
        			document.getElementById("graphcragin").checked = false;
        		}
        		if(currentdorm != "Gebbie")
        		{
        			d3.selectAll(".gebbie").remove();
        			document.getElementById("graphgebbie").checked = false;
        		}
        		if(currentdorm != "Keefe")
        		{
        			d3.selectAll(".keefe").remove();
        			document.getElementById("graphkeefe").checked = false;
        		}
        		if(currentdorm != "Beard")
        		{
        			d3.selectAll(".beard").remove();
        			document.getElementById("graphbeard").checked = false;
        		}
        		if(currentdorm != "Meadows")
        		{
        			d3.selectAll(".meadows").remove();
        			document.getElementById("graphmeadows").checked = false;
        		}
        		if(currentdorm != "Clark")
        		{
        			d3.selectAll(".clark").remove();
        			document.getElementById("graphclark").checked = false;
        		}
        		if(currentdorm != "McIntire")
        		{
        			d3.selectAll(".mcintire").remove();
        			document.getElementById("graphmcintire").checked = false;
        		}
        		if(currentdorm != "Young")
        		{
        			d3.selectAll(".young").remove();
        			document.getElementById("graphyoung").checked = false;
        		}
        		
        		var mult =1;
        		if(converttomoney)
        			mult = moneyconversion;
        		
        		yRange2 = d3.scale.linear().range([HEIGHT - MARGINS.top, MARGINS.bottom]).domain([0, mult*maxy]),
				d3.selectAll("#yaxis").remove();
	  
				yAxis = d3.svg.axis()
				  .scale(yRange2)
				  .tickSize(5)
				  .orient('left')
				  .tickSubdivide(true);
	  

				svg.append('svg:g')
				  .attr('class', 'pop')
				  .attr('id', 'yaxis')
				  .attr('transform', 'translate(' + (130+MARGINS.left) + ',260)')
				  .call(yAxis);
        		
        		document.getElementById("xaxisscale").value = "day";
        		data = getDataToUse(currentdorm);
        		str = currentdorm.replace(/\s+/g, '');
        		str = str.toLowerCase()
        		d3.selectAll("."+str).remove();
        		d3.selectAll("#xaxis").remove();
        		minDate = maxDate-secondsinday;
				
				data = data.filter(function (el) 
				{
					return el.time <= maxDate && el.time>=minDate;
				});
			   xRange = d3.time.scale().domain([new Date(minDate*1000), new Date(maxDate*1000)]).range([MARGINS.left, WIDTH - MARGINS.right]),
				
				 xAxis = d3.svg.axis()
				  .scale(xRange)
				  .tickSize(numticks)
				  .ticks(numticks);
				
				svg.append('svg:g')
				  .attr('class', 'pop')
				  .attr('id', 'xaxis')
				  .attr('transform', 'translate(130,' + (HEIGHT - MARGINS.bottom +260) + ')')
				  .call(xAxis);
				  
				  var lineFunc = d3.svg.line()
					  .x(function(d) {
						return xRange(new Date(1000*d.time));
					  })
					  .y(function(d) {
						return yRange(d.energy);
					  })
					  .interpolate('linear');
  
					  svg.append('svg:path')
					  .attr('d', lineFunc(data))
					  .attr('stroke', 'black')
					  .attr('stroke-width', 2)
					  .attr("class", function(){return getClass(currentdorm);})
					  .attr('transform', 'translate(130,260)')
					  .on("mouseover", function() {					//display info on mouseover
          				tooltip.transition()
               					.duration(200)
               					.style("opacity", .9);
          				tooltip.html(currentdorm)
               					.style("left", (d3.event.pageX+4) + "px")
               					.style("top", (d3.event.pageY+4) + "px");
               			})
               		.on("mouseout", function(d) {					//hide info on mouseout
          				tooltip.transition()
               					.duration(500)
               					.style("opacity", 0);})
  .attr('fill', 'none');
        	}
        	
        	function readAllData(num, c)
			{
				loadXMLDoc(dorms[0]);	//beard
				loadXMLDoc(dorms[6]);	//larcom
				loadXMLDoc(dorms[1]);	//chapin
				loadXMLDoc(dorms[4]);	//everett heights
				loadXMLDoc(dorms[15]);	//metcalf
				loadXMLDoc(dorms[17]);	//kilham
				loadXMLDoc(dorms[3]);	//emerson hall
				loadXMLDoc(dorms[16]);	//stanton/cragin/everett
				loadXMLDoc(dorms[5]);	//gebbie/keefe
				loadXMLDoc(dorms[2]);	//ymc
				loadXMLDoc(dorms[14]);	//meadows
				drawbackground();
				setTimeout(c, 2000);
			}
			
			function loadXMLDoc(dormNumber) {//function to setup the xml load and callback
			  var xmlhttp = new XMLHttpRequest();
			  xmlhttp.onreadystatechange = function() {	//open xml file
				if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
					switch(dormNumber) {
						case "http://cs.wheatonma.edu/~egauge/beard/beard.xml":
							console.log("got to beard case");
							beard = readData(xmlhttp,numbeard);
							currentDorm = beard;
							break;
						case "http://cs.wheatonma.edu/~egauge/chapin/chapin.xml":
							console.log("got to chapin case");
							chapin = readData(xmlhttp,numchapin);
							currentDorm = chapin;
							break;
						case "http://cs.wheatonma.edu/~egauge/clark-mcintire-young/clark-mcintire-young.xml"://DONE
							console.log("got to ymc case");//tripple case
							ymc = readData1(xmlhttp);
							YMCtrue = true;
							YMCcustom(ymc);
							break;
						case "http://cs.wheatonma.edu/~egauge/emerson-dorm/emerson-dorm.xml"://DONE
							console.log("got to emerson case");
							emerson = readData2(xmlhttp);
							emersonCustom(emerson);
							break;
						case "http://cs.wheatonma.edu/~egauge/everett-heights/everett-heights.xml":
							console.log("got to everett case");
							everettheights = readData(xmlhttp,numeverettheights);
							currentDorm = everettheights;
							break;
						case "http://cs.wheatonma.edu/~egauge/kilham/kilham.xml":
							console.log("got to kilham case");
							kilhamOriginal = readData4(xmlhttp,numkilham);
							kilhamCustom(kilhamOriginal);
							break;
						 case "http://cs.wheatonma.edu/~egauge/larcom/larcom.xml":
							console.log("got to larcom case");
							larcomOriginal = readData2(xmlhttp);
							currentDorm = larcomOriginal;
							larcomCustom(larcomOriginal);
							break;
						case "http://cs.wheatonma.edu/~egauge/gebbie-keefe/gebbie-keefe.xml":
							console.log("got to Gebbie/Keefe case");
							gebbieKeefe = readData2(xmlhttp);
							gebbieKeefeCustom(gebbieKeefe);
							break;
						case "http://cs.wheatonma.edu/~egauge/meadows-north-4th-floor/meadows-north-4th-floor.xml":
							console.log("got to meadowsN2 case");
							meadowsN2 = readData(xmlhttp,nummeadows);
							currentDorm = meadowsN2;
							meadowsCustom(meadowsN2);
							break;
						case "http://cs.wheatonma.edu/~egauge/stanton-cragin-everett/stanton-cragin-everett.xml":
							console.log("got to stanton/cragin/everett case");
							StantonCraginEverett = readData3(xmlhttp);
							SCEcustom(StantonCraginEverett);
							break;
						case "http://cs.wheatonma.edu/~egauge/metcalf/metcalf.xml":
							console.log("got to metcalf case");
							metcalf = readData(xmlhttp,nummetcalf);
							currentDorm = metcalf;
							break;
						default:
							console.log("missed: " + dormNumber);
					}
				}
				else{//alert("Didn't work");
				}
			  };
			  xmlhttp.open("GET", dormNumber, true);
			  xmlhttp.send();
			}//end of loadXMLDoc

			function readData(xmlhttp,numstudents) {//function to do the actual xml load
				var buildingData= [];
				var counter = 0;
				var energyCalc = 0;
				var xmlDoc = xmlhttp.responseXML;
				var timeStamp = xmlDoc.getElementsByTagName("data");//get time stamp
				timeStamp = timeStamp[0].getAttribute("time_stamp");//get time stamp
				timeStamp = parseInt(timeStamp, 16);//parse time stamp
				recenttime = timeStamp;
				timeStamp += 3600;//get start time and add one day for the loop to subtract
				var firstEnergyElement = xmlDoc.getElementsByTagName("c");//get energy
	
				var firstEnergyValue = firstEnergyElement[0].childNodes[0].nodeValue;
				var entryLength = firstEnergyElement.length;//get length of xml file
				for (var i = 0; i < entryLength; i++) {
					timeStamp = (timeStamp - 3600);
					var currentEnergyValue = firstEnergyElement[i].childNodes[0].nodeValue;
					energyCalc = firstEnergyValue - currentEnergyValue;
					if(energyCalc <= 0 || energyCalc/1000/numstudents>2500)
					{
					}
					else
					{
						buildingData.push({time:timeStamp, energy:energyCalc/1000/numstudents});
					}
					firstEnergyValue = currentEnergyValue;
					counter = counter + 1;
				}
				// buildingData.push({time:"Total Values Added", energy:counter});
				return buildingData;
			}//end of readData
			
			function readData1(xmlhttp) {//function to do the actual xml load
				var buildingData= [];
				var counter = 0;
				var energyCalc = 0;
				var xmlDoc = xmlhttp.responseXML;
				var timeStamp = xmlDoc.getElementsByTagName("data");//get time stamp
				timeStamp = timeStamp[0].getAttribute("time_stamp");//get time stamp
				timeStamp = parseInt(timeStamp, 16);//parse time stamp
				var firstEnergyElement = xmlDoc.getElementsByTagName("c");//get energy
				for (var i = 0; i < firstEnergyElement.length; i++) {
					energyCalc = firstEnergyElement[i].childNodes[0].nodeValue;
					buildingData.push({time:timeStamp, energy:energyCalc/1000});
				}

				return buildingData;
			}//end of readData1
		
			function readData2(xmlhttp) {//function to do the actual xml load
			var buildingData= [];
			var counter = 0;
			var energyCalc = 0;
			var xmlDoc = xmlhttp.responseXML;
			var timeStamp = xmlDoc.getElementsByTagName("data");//get time stamp
			timeStamp = timeStamp[0].getAttribute("time_stamp");//get time stamp
			timeStamp = parseInt(timeStamp, 16);//parse time stamp
			var firstEnergyElement = xmlDoc.getElementsByTagName("c");//get energy
			for (var i = 0; i < firstEnergyElement.length; i++) 
			{
				energyCalc = firstEnergyElement[i].childNodes[0].nodeValue;
				buildingData.push({time:timeStamp, energy:energyCalc/1000});
			}

			return buildingData;
		}//end of readData2
		
		function readData3(xmlhttp) {//function to do the actual xml load
			var buildingData= [];
			var counter = 0;
			var energyCalc = 0;
			var xmlDoc = xmlhttp.responseXML;
			var timeStamp = xmlDoc.getElementsByTagName("data");//get time stamp
			timeStamp = timeStamp[0].getAttribute("time_stamp");//get time stamp
			timeStamp = parseInt(timeStamp, 16);//parse time stamp
			var firstEnergyElement = xmlDoc.getElementsByTagName("c");//get energy
			for (var i = 0; i < firstEnergyElement.length; i++) 
			{
				energyCalc = firstEnergyElement[i].childNodes[0].nodeValue;
				buildingData.push({time:timeStamp, energy:energyCalc/1000});
			}

			return buildingData;
		}//end of readData2
		
		function readData4(xmlhttp,numstudents) {//function to do the actual xml load
			var buildingData= [];
			var counter = 0;
			var energyCalc = 0;
			var xmlDoc = xmlhttp.responseXML;
			var timeStamp = xmlDoc.getElementsByTagName("data");//get time stamp
			timeStamp = timeStamp[0].getAttribute("time_stamp");//get time stamp
			timeStamp = parseInt(timeStamp, 16);//parse time stamp
			var firstEnergyElement = xmlDoc.getElementsByTagName("c");//get energy
			for (var i = 0; i < firstEnergyElement.length; i++) 
			{
				energyCalc = firstEnergyElement[i].childNodes[0].nodeValue;
				buildingData.push({time:timeStamp, energy:energyCalc/1000});
			}

			return buildingData;
		}//end of readData2
		
		function kilhamCustom(kilhamOriginal)
		{
			var energyCalc = 0;
			var currentTime = kilhamOriginal[0].time;
			var firstEnergyValue = kilhamOriginal[0].energy;
			for(var i=0; i<kilhamOriginal.length; i=i+10){
				var currentEnergyValue = kilhamOriginal[i].energy;
				energyCalc = firstEnergyValue - currentEnergyValue;
				if(energyCalc <= 0 || energyCalc/numkilham>2500){
				}
				else{
					kilham1.push({time:currentTime, energy:energyCalc});
				}
				firstEnergyValue = currentEnergyValue;
				currentTime = currentTime - 3600;
			}
			var energyCalc = 0;
			var currentTime = kilhamOriginal[1].time;
			var firstEnergyValue = kilhamOriginal[1].energy;
			for(var i=1; i<kilhamOriginal.length; i=i+10){
				var currentEnergyValue = kilhamOriginal[i].energy;
				energyCalc = firstEnergyValue - currentEnergyValue;
				if(energyCalc <= 0 || energyCalc/numkilham>2500){
				}
				else{
					kilham2.push({time:currentTime, energy:energyCalc});
				}
				firstEnergyValue = currentEnergyValue;
				currentTime = currentTime - 3600;
			}	
			
			for(var i = 0; i<kilham1.length; i++){
				kilham.push({time:kilham1[i].time, energy: (kilham1[i].energy+ kilham2[i].energy)/numkilham});
			}
		}
		
		function emersonCustom(emerson){
			var energyCalc = 0;
			var currentTime = emerson[0].time;
			var firstEnergyValue = emerson[0].energy;
			for(var i=0; i<emerson.length; i=i+2){
				var currentEnergyValue = emerson[i].energy;
				energyCalc = firstEnergyValue - currentEnergyValue;
				if(energyCalc <= 0 || energyCalc/numemersonhall>2500){
				}
				else{
					emersonA.push({time:currentTime, energy:energyCalc});
				}
				firstEnergyValue = currentEnergyValue;
				currentTime = currentTime - 3600;
			}
			var energyCalc = 0;
			var currentTime = emerson[1].time;
			var firstEnergyValue = emerson[1].energy;
			for(var i=1; i<emerson.length; i=i+2){
				var currentEnergyValue = emerson[i].energy;
				energyCalc = firstEnergyValue - currentEnergyValue;
				if(energyCalc <= 0 || energyCalc/numemersonhall>2500){
				}
				else{
					emersonB.push({time:currentTime, energy:energyCalc});
				}
				firstEnergyValue = currentEnergyValue;
				currentTime = currentTime - 3600;
			}
			
			for(var i = 0; i<emersonA.length; i++){
				emersonhall.push({time:emersonA[i].time, energy: (emersonA[i].energy+ emersonB[i].energy)/numemersonhall});
			}
}
		
		function larcomCustom(larcomOriginal){
			var energyCalc = 0;
			var currentTime = larcomOriginal[0].time;
			var firstEnergyValue = larcomOriginal[0].energy;
			for(var i=0; i<larcomOriginal.length; i=i+2){
				var currentEnergyValue = larcomOriginal[i].energy;
				energyCalc = firstEnergyValue - currentEnergyValue;
				if(energyCalc <= 0|| energyCalc/numlarcom>2500){
				}
				else{
					larcomDorm.push({time:currentTime, energy:energyCalc});
				}
				firstEnergyValue = currentEnergyValue;
				currentTime = currentTime - 3600;
			}
			var energyCalc = 0;
			var currentTime = larcomOriginal[1].time;
			var firstEnergyValue = larcomOriginal[1].energy;
			for(var i=1; i<larcomOriginal.length; i=i+2){
				var currentEnergyValue = larcomOriginal[i].energy;
				energyCalc = firstEnergyValue - currentEnergyValue;
				if(energyCalc <= 0 || energyCalc/numlarcom>2500){
				}
				else{
					larcomComp.push({time:currentTime, energy:energyCalc});
				}
				firstEnergyValue = currentEnergyValue;
				currentTime = currentTime - 3600;
			}
			
			for(var i = 0; i<larcomComp.length; i++){
				larcom.push({time:larcomDorm[i].time, energy: (larcomDorm[i].energy+ larcomComp[i].energy)/numlarcom});
			}
		}
		
		function SCEcustom(SCE){
	// alert("Got to SCEcustom");
			var energyCalc = 0;
			var currentTime = SCE[0].time;
			var firstEnergyValue = SCE[0].energy;
			for(var i=0; i<SCE.length; i=i+4){
				var currentEnergyValue = SCE[i].energy;
				energyCalc = firstEnergyValue - currentEnergyValue;
				if(energyCalc <= 0 || energyCalc/numstanton>2500)
				{
				}
				else{
					stantonDorm.push({time:currentTime, energy:energyCalc});
				}
				firstEnergyValue = currentEnergyValue;
				currentTime = currentTime - 3600;
			}
			var energyCalc = 0;
			var currentTime = SCE[1].time;
			var firstEnergyValue = SCE[1].energy;
			for(var i=1; i<SCE.length; i=i+4){
				var currentEnergyValue = SCE[i].energy;
				energyCalc = firstEnergyValue - currentEnergyValue;
				if(energyCalc <= 0 || energyCalc/numstanton>2500){
				}
				else{
					stantonComp.push({time:currentTime, energy:energyCalc});
				}
				firstEnergyValue = currentEnergyValue;
				currentTime = currentTime - 3600;
			}
			var energyCalc = 0;
			var currentTime = SCE[2].time;
			var firstEnergyValue = SCE[2].energy;
			for(var i=2; i<SCE.length; i=i+4){
				var currentEnergyValue = SCE[i].energy;
				energyCalc = firstEnergyValue - currentEnergyValue;
				if(energyCalc <= 0 || energyCalc/numcragin>2500){
				}
				else{
					cragin.push({time:currentTime, energy:energyCalc/numcragin});
				}
				firstEnergyValue = currentEnergyValue;
				currentTime = currentTime - 3600;
			}
			var energyCalc = 0;
			var currentTime = SCE[3].time;
			var firstEnergyValue = SCE[3].energy;
			for(var i=3; i<SCE.length; i=i+4){
				var currentEnergyValue = SCE[i].energy;
				energyCalc = firstEnergyValue - currentEnergyValue;
				if(energyCalc <= 0 || energyCalc/numeveretthall>2500){
				}
				else{
					everetthall.push({time:currentTime, energy:energyCalc/numeveretthall});
				}
				firstEnergyValue = currentEnergyValue;
				currentTime = currentTime - 3600;
			}
			
			for(var i = 0; i<stantonComp.length; i++){
				stanton.push({time:stantonComp[i].time, energy: (stantonComp[i].energy+ stantonDorm[i].energy)/numstanton});
			}
			}
			
		function gebbieKeefeCustom(gebbieKeefe){
			var energyCalc = 0;
			var currentTime = gebbieKeefe[0].time;
			var firstEnergyValue = gebbieKeefe[0].energy;
			if(firstEnergyValue < 0)
				firstEnergyValue = firstEnergyValue*-1;
			for(var i=0; i<gebbieKeefe.length; i=i+2){
				var currentEnergyValue = gebbieKeefe[i].energy;
				if(currentEnergyValue < 0)
					currentEnergyValue = currentEnergyValue*-1;
				energyCalc = firstEnergyValue - currentEnergyValue;
				if(energyCalc <= 0 || energyCalc/numgebbie>2500){
				}
				else{
					gebbie.push({time:currentTime, energy:energyCalc/numgebbie});
				}
				firstEnergyValue = currentEnergyValue;
				currentTime = currentTime - 3600;
			}
			var energyCalc = 0;
			var currentTime = gebbieKeefe[1].time;
			var firstEnergyValue = gebbieKeefe[1].energy;
			if(firstEnergyValue < 0)
				firstEnergyValue = firstEnergyValue*-1;
			for(var i=1; i<gebbieKeefe.length; i=i+2){
				var currentEnergyValue = gebbieKeefe[i].energy;
				if(currentEnergyValue < 0)
					currentEnergyValue = currentEnergyValue*-1;
				energyCalc = firstEnergyValue - currentEnergyValue;
				if(energyCalc <= 0|| energyCalc/numkeefe>2500){
				}
				else{
					keefe.push({time:currentTime, energy:energyCalc/numkeefe});
				}
				firstEnergyValue = currentEnergyValue;
				currentTime = currentTime - 3600;
			}
		}
		
		function YMCcustom(ymc){
			var energyCalc = 0;
			var currentTime = ymc[0].time;
			var firstEnergyValue = ymc[0].energy;
			for(var i=0; i<ymc.length; i=i+3){
				var currentEnergyValue = ymc[i].energy;
				energyCalc = firstEnergyValue - currentEnergyValue;
				if(energyCalc <= 0 || energyCalc/numyoung>2500){
				}
				else{
					young.push({time:currentTime, energy:energyCalc/numyoung});
			
				}
				firstEnergyValue = currentEnergyValue;
				currentTime = currentTime - 3600;
			}
			var energyCalc = 0;
			var currentTime = ymc[1].time;
			var firstEnergyValue = ymc[1].energy;
			for(var i=1; i<ymc.length; i=i+3){
				var currentEnergyValue = ymc[i].energy;
				energyCalc = firstEnergyValue - currentEnergyValue;
				if(energyCalc <= 0 || energyCalc/nummcintire>2500){
				}
				else{
					mcintire.push({time:currentTime, energy:energyCalc/nummcintire});
				}
				firstEnergyValue = currentEnergyValue;
				currentTime = currentTime - 3600;
			}
			var energyCalc = 0;
			var currentTime = ymc[2].time;
			var firstEnergyValue = ymc[2].energy;
			for(var i=2; i<ymc.length; i=i+3){
				var currentEnergyValue = ymc[i].energy;
				energyCalc = firstEnergyValue - currentEnergyValue;
				if(energyCalc <= 0 || energyCalc/numclark>2500){
					//got here
				}
				else{
					clark.push({time:currentTime, energy:energyCalc/numclark});
			
				}
				firstEnergyValue = currentEnergyValue;
				currentTime = currentTime - 3600;
			}
		}
		
		function meadowsCustom(m)
		{
			for(var i = 0; i<m.length; i++){
				meadows.push({time:m[i].time, energy: (m[i].energy*8)});
			}
		}
        	
        	
        	//setup();
        	readAllData(1, function(){setup()});
            var modify = document.lastModified;
            document.getElementById("update").innerHTML= "Last updated "+modify;
        </script>
      
    </body>
</html>
